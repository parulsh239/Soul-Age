<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Soul Age Calculator - Vedantic & Theosophical Analysis</title>
    
    
    <!-- Security Headers via Meta Tags -->
    <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self' 'unsafe-inline'; style-src 'self' 'unsafe-inline'; img-src 'self' data:; font-src 'self'; connect-src 'self'; frame-ancestors 'none';">
    <meta http-equiv="X-Content-Type-Options" content="nosniff">
    <meta http-equiv="X-Frame-Options" content="DENY">
    <meta http-equiv="X-XSS-Protection" content="1; mode=block">
    <meta http-equiv="Referrer-Policy" content="no-referrer">
    <meta http-equiv="Permissions-Policy" content="geolocation=(), microphone=(), camera=()">
    
    <!-- SEO & Privacy Compliant Meta Tags -->
    <meta name="description" content="Discover your soul's evolutionary journey through 777 incarnations using Vedantic wisdom and Theosophical teachings. GDPR-compliant, no data storage.">
    <meta name="keywords" content="soul age, 777 incarnations, Vedanta, Theosophy, spiritual evolution, Jaimini astrology, karma, reincarnation">
    <meta name="author" content="Soul Age Calculator">
    <meta name="robots" content="index, follow">
    
    <!-- Privacy & Security -->
    <meta name="privacy" content="No user data collected or stored">
    <meta http-equiv="Content-Security-Policy" content="default-src 'self' 'unsafe-inline'; img-src 'self' data:; script-src 'self' 'unsafe-inline';">
    
    <!-- Open Graph -->
    <meta property="og:title" content="Soul Age Calculator - Discover Your Spiritual Evolution">
    <meta property="og:description" content="Calculate your position in the 777-incarnation journey using ancient Vedantic and Theosophical wisdom.">
    <meta property="og:type" content="website">
    
    <style>
        :root {
            --primary: #6B46C1;
            --secondary: #9333EA;
            --accent: #F59E0B;
            --success: #10B981;
            --warning: #F59E0B;
            --error: #EF4444;
            --text: #1F2937;
            --light-bg: #F9FAFB;
            --white: #FFFFFF;
            --border: #E5E7EB;
            --shadow: rgba(0, 0, 0, 0.1);
            --gradient: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            --sacred-gold: #FFD700;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', system-ui, -apple-system, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 50%, #f093fb 100%);
            min-height: 100vh;
            color: var(--text);
            line-height: 1.6;
            position: relative;
        }

        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><text x="50" y="50" font-size="80" fill="%23ffffff08" text-anchor="middle" dominant-baseline="middle">☸</text></svg>') center/200px;
            pointer-events: none;
            opacity: 0.1;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
            position: relative;
            z-index: 1;
        }

        /* Header */
        .header {
            text-align: center;
            padding: 40px 20px;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            margin-bottom: 30px;
            box-shadow: 0 20px 40px var(--shadow);
            position: relative;
            overflow: hidden;
        }

        .header::before {
            content: '॥ ॐ तत् सत् ॥';
            position: absolute;
            top: 10px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 14px;
            color: var(--primary);
            opacity: 0.5;
        }

        .header h1 {
            font-size: 2.5rem;
            background: var(--gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 10px;
            font-weight: 700;
        }

        .header .subtitle {
            color: #6B7280;
            font-size: 1.1rem;
            margin-bottom: 20px;
        }

        .privacy-notice {
            display: inline-block;
            background: #10B98120;
            color: #065F46;
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 0.9rem;
            margin-top: 10px;
        }

        /* Tabs Navigation */
        .tabs-nav {
            display: flex;
            gap: 10px;
            margin-bottom: 30px;
            background: rgba(255, 255, 255, 0.95);
            padding: 10px;
            border-radius: 15px;
            box-shadow: 0 10px 25px var(--shadow);
            flex-wrap: wrap;
            justify-content: center;
        }

        .tab-btn {
            padding: 12px 24px;
            background: transparent;
            border: 2px solid transparent;
            border-radius: 10px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 600;
            color: #6B7280;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .tab-btn:hover {
            background: #F3F4F6;
        }

        .tab-btn.active {
            background: var(--gradient);
            color: white;
            border-color: transparent;
        }

        .tab-icon {
            font-size: 1.2rem;
        }

        /* Tab Content */
        .tab-content {
            display: none;
            animation: fadeIn 0.5s ease;
        }

        .tab-content.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Sections */
        .section {
            background: rgba(255, 255, 255, 0.98);
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 20px;
            box-shadow: 0 10px 30px var(--shadow);
            position: relative;
        }

        .section-header {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 2px solid var(--border);
        }

        .section-icon {
            font-size: 1.5rem;
            color: var(--primary);
        }

        .section-title {
            font-size: 1.5rem;
            color: var(--text);
            font-weight: 600;
        }

        /* Form Styles */
        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }

        .form-group {
            position: relative;
        }

        .form-group label {
            display: flex;
            align-items: center;
            gap: 5px;
            font-weight: 600;
            color: var(--text);
            margin-bottom: 8px;
            font-size: 0.95rem;
        }

        .form-group input,
        .form-group select {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid var(--border);
            border-radius: 10px;
            font-size: 1rem;
            transition: all 0.3s ease;
            background: var(--white);
        }

        .form-group input:focus,
        .form-group select:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(107, 70, 193, 0.1);
        }

        .validation-indicator {
            display: inline-block;
            width: 8px;
            height: 8px;
            border-radius: 50%;
            margin-left: 5px;
        }

        .validation-indicator.valid {
            background: var(--success);
        }

        .validation-indicator.invalid {
            background: var(--error);
        }

        /* Autocomplete */
        .autocomplete-container {
            position: relative;
        }

        .autocomplete-dropdown {
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            background: white;
            border: 2px solid var(--border);
            border-top: none;
            border-radius: 0 0 10px 10px;
            max-height: 200px;
            overflow-y: auto;
            z-index: 1000;
            display: none;
            box-shadow: 0 5px 15px var(--shadow);
        }

        .autocomplete-item {
            padding: 12px 15px;
            cursor: pointer;
            border-bottom: 1px solid var(--border);
            transition: background 0.2s;
        }

        .autocomplete-item:hover {
            background: #F3F4F6;
        }

        /* Survey Questions */
        .survey-grid {
            display: grid;
            gap: 15px;
            margin-bottom: 20px;
        }

        .question-card {
            background: #F9FAFB;
            padding: 20px;
            border-radius: 12px;
            border-left: 4px solid var(--primary);
        }

        .question-text {
            font-weight: 600;
            margin-bottom: 12px;
            color: var(--text);
        }

        .question-card select {
            width: 100%;
            padding: 10px;
            border: 2px solid var(--border);
            border-radius: 8px;
            background: white;
            cursor: pointer;
        }

        /* Calculate Button */
        .calculate-btn {
            background: var(--gradient);
            color: white;
            padding: 18px 40px;
            border: none;
            border-radius: 50px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: block;
            margin: 30px auto;
            min-width: 250px;
            box-shadow: 0 10px 25px rgba(147, 51, 234, 0.3);
        }

        .calculate-btn:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 15px 35px rgba(147, 51, 234, 0.4);
        }

        .calculate-btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }

        /* Results Display */
        .results-container {
            display: none;
            margin-top: 30px;
        }

        .results-container.show {
            display: block;
            animation: fadeIn 0.5s ease;
        }

        .soul-age-display {
            background: var(--gradient);
            color: white;
            padding: 40px;
            border-radius: 20px;
            text-align: center;
            margin-bottom: 30px;
            position: relative;
            overflow: hidden;
        }

        .soul-age-display::before {
            content: '☸';
            position: absolute;
            top: -50px;
            right: -50px;
            font-size: 200px;
            opacity: 0.1;
        }

        .soul-age-number {
            font-size: 4rem;
            font-weight: bold;
            margin-bottom: 10px;
            text-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);
        }

        .soul-stage {
            font-size: 1.5rem;
            margin-bottom: 20px;
            opacity: 0.95;
        }

        .incarnation-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 20px;
            margin-top: 30px;
        }

        .stat-card {
            background: rgba(255, 255, 255, 0.2);
            padding: 15px;
            border-radius: 12px;
            backdrop-filter: blur(10px);
        }

        .stat-value {
            font-size: 1.8rem;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .stat-label {
            font-size: 0.9rem;
            opacity: 0.9;
        }

        /* Understanding Tab Styles */
        .wisdom-card {
            background: linear-gradient(135deg, #F9FAFB 0%, #F3F4F6 100%);
            padding: 25px;
            border-radius: 15px;
            margin-bottom: 20px;
            border-left: 5px solid var(--primary);
        }

        .wisdom-header {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 15px;
            font-size: 1.2rem;
            font-weight: 600;
            color: var(--primary);
        }

        .evolution-stages {
            display: grid;
            gap: 20px;
            margin: 30px 0;
        }

        .stage-card {
            background: white;
            border: 2px solid var(--border);
            border-radius: 15px;
            padding: 25px;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .stage-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 30px var(--shadow);
            border-color: var(--primary);
        }

        .stage-card.current {
            border-color: var(--sacred-gold);
            background: linear-gradient(135deg, rgba(255, 215, 0, 0.05), rgba(255, 255, 255, 1));
        }

        .stage-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .stage-range {
            background: var(--primary);
            color: white;
            padding: 6px 15px;
            border-radius: 20px;
            font-size: 0.9rem;
            font-weight: 600;
        }

        .stage-title {
            font-size: 1.3rem;
            font-weight: bold;
            color: var(--text);
            margin-bottom: 10px;
        }

        .stage-description {
            color: #6B7280;
            line-height: 1.8;
        }

        /* Loading State */
        .loading {
            display: none;
            text-align: center;
            padding: 40px;
        }

        .loading.show {
            display: block;
        }

        .spinner {
            display: inline-block;
            width: 50px;
            height: 50px;
            border: 4px solid rgba(147, 51, 234, 0.2);
            border-top-color: var(--primary);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Responsive */
        @media (max-width: 768px) {
            .header h1 {
                font-size: 1.8rem;
            }
            
            .tabs-nav {
                gap: 5px;
            }
            
            .tab-btn {
                padding: 10px 15px;
                font-size: 0.9rem;
            }
            
            .section {
                padding: 20px;
            }
            
            .soul-age-number {
                font-size: 3rem;
            }
        }

        /* Sacred Geometry Background */
        .sacred-bg {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            pointer-events: none;
            opacity: 0.03;
            background-image: 
                radial-gradient(circle at 20% 40%, var(--primary) 1px, transparent 1px),
                radial-gradient(circle at 80% 60%, var(--secondary) 1px, transparent 1px);
            background-size: 50px 50px;
        }

        /* Error Messages */
        .error-message {
            color: var(--error);
            font-size: 0.85rem;
            margin-top: 5px;
            display: none;
        }

        .error-message.show {
            display: block;
        }

        /* Security Notice */
        .security-badge {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: rgba(16, 185, 129, 0.95);
            color: white;
            padding: 10px 20px;
            border-radius: 50px;
            font-size: 0.85rem;
            display: flex;
            align-items: center;
            gap: 8px;
            box-shadow: 0 5px 15px rgba(16, 185, 129, 0.3);
            z-index: 1000;
        }
    </style>
</head>
<body>
    <div class="sacred-bg"></div>
    
    <div class="container">
        <!-- Header -->
        <header class="header">
            <h1>🕉️ Soul Age Calculator</h1>
            <p class="subtitle">Discover Your Position in the 777-Incarnation Journey</p>
            <p style="color: #6B7280; margin: 15px 0;">
                Based on ancient Vedantic wisdom and Theosophical teachings, revealing your soul's evolutionary stage through the eternal cycle of Samsara.
            </p>
            <div class="privacy-notice">
                🔒 100% Privacy Guaranteed - No Data Storage - GDPR Compliant
            </div>
        </header>

        <!-- Tabs Navigation -->
        <nav class="tabs-nav">
            <button class="tab-btn active" data-tab="calculate">
                <span class="tab-icon">📊</span>
                Calculate
            </button>
            <button class="tab-btn" data-tab="understanding">
                <span class="tab-icon">📚</span>
                Understanding
            </button>
            <button class="tab-btn" data-tab="jaimini">
                <span class="tab-icon">🔮</span>
                Jaimini Analysis
            </button>
            <button class="tab-btn" data-tab="guidance">
                <span class="tab-icon">🧘</span>
                Spiritual Guidance
            </button>
        </nav>

        <!-- Tab 1: Calculate -->
        <div id="calculate-tab" class="tab-content active">
            <!-- Birth Information -->
            <div class="section">
                <div class="section-header">
                    <span class="section-icon">⭐</span>
                    <h2 class="section-title">Birth Information</h2>
                </div>
                
                <form id="birthForm" novalidate>
                    <div class="form-grid">
                        <div class="form-group">
                            <label for="birthDate">
                                Birth Date
                                <span class="validation-indicator" id="dateValidation"></span>
                            </label>
                            <input type="date" id="birthDate" required>
                            <div class="error-message" id="dateError"></div>
                        </div>
                        
                        <div class="form-group">
                            <label for="birthTime">
                                Birth Time
                                <span class="validation-indicator" id="timeValidation"></span>
                            </label>
                            <div style="display: flex; gap: 8px;">
                                <select id="birthHour" required>
                                    <option value="">HH</option>
                                    <option value="1">01</option>
                                    <option value="2">02</option>
                                    <option value="3">03</option>
                                    <option value="4">04</option>
                                    <option value="5">05</option>
                                    <option value="6">06</option>
                                    <option value="7">07</option>
                                    <option value="8">08</option>
                                    <option value="9">09</option>
                                    <option value="10">10</option>
                                    <option value="11">11</option>
                                    <option value="12">12</option>
                                </select>
                                <input type="number" id="birthMinute" placeholder="MM" min="0" max="59" required>
                                <select id="ampm" required>
                                    <option value="">--</option>
                                    <option value="AM">AM</option>
                                    <option value="PM">PM</option>
                                </select>
                            </div>
                            <div class="error-message" id="timeError"></div>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="birthPlace">
                            Birth Location
                            <span class="validation-indicator" id="placeValidation"></span>
                        </label>
                        <div class="autocomplete-container">
                            <input type="text" id="birthPlace" placeholder="Start typing city name..." required>
                            <div class="autocomplete-dropdown" id="autocompleteDropdown"></div>
                        </div>
                        <div class="error-message" id="placeError"></div>
                    </div>
                    
                    <div class="form-grid">
                        <div class="form-group">
                            <label>Latitude</label>
                            <input type="number" id="latitude" step="0.0001" readonly>
                        </div>
                        <div class="form-group">
                            <label>Longitude</label>
                            <input type="number" id="longitude" step="0.0001" readonly>
                        </div>
                    </div>
                </form>
            </div>

            <!-- Spiritual Assessment -->
            <div class="section">
                <div class="section-header">
                    <span class="section-icon">🧘</span>
                    <h2 class="section-title">Spiritual Experience Assessment</h2>
                </div>
                
                <p style="color: #6B7280; margin-bottom: 20px;">
                    These questions help calibrate your soul age calculation by assessing karmic patterns and spiritual development markers.
                </p>
                
                <div class="survey-grid" id="surveyQuestions">
                    <!-- Will be populated by JavaScript -->
                </div>
            </div>

            <button class="calculate-btn" id="calculateBtn">
                ✨ Calculate My Soul Age
            </button>

            <!-- Loading State -->
            <div class="loading" id="loading">
                <div class="spinner"></div>
                <p style="margin-top: 20px; color: var(--primary);">
                    Analyzing your karmic blueprint through Vedantic algorithms...
                </p>
            </div>

            <!-- Results -->
            <div class="results-container" id="resultsContainer">
                <div class="soul-age-display">
                    <div class="soul-age-number" id="soulAgeNumber">~432</div>
                    <div class="soul-stage" id="soulStage">Mature Soul - Heart Chakra Activation</div>
                    
                    <div class="incarnation-grid">
                        <div class="stat-card">
                            <div class="stat-value" id="incarnationRange">425-440</div>
                            <div class="stat-label">Incarnation Range</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-value" id="earthYears">~71k</div>
                            <div class="stat-label">Earth Years</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-value" id="spiralLevel">4th</div>
                            <div class="stat-label">Spiral Level</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-value" id="remainingLives">345</div>
                            <div class="stat-label">Lives to Liberation</div>
                        </div>
                    </div>
                </div>

                <div class="section">
                    <div class="section-header">
                        <span class="section-icon">🎯</span>
                        <h2 class="section-title">Your Soul Characteristics</h2>
                    </div>
                    <div id="characteristicsDisplay">
                        <!-- Will be populated by JavaScript -->
                    </div>
                </div>
            </div>
        </div>

        <!-- Tab 2: Understanding -->
        <div id="understanding-tab" class="tab-content">
            <div class="section">
                <div class="section-header">
                    <span class="section-icon">🕉️</span>
                    <h2 class="section-title">The 777-Incarnation Framework</h2>
                </div>

                <div class="wisdom-card">
                    <div class="wisdom-header">
                        <span>📜</span>
                        <span>Ancient Wisdom Synthesis</span>
                    </div>
                    <p style="line-height: 1.8; color: #4B5563;">
                        The 777-incarnation model synthesizes <strong>Vedantic concepts of Samsara</strong> (the wheel of birth and death) with 
                        <strong>Theosophical teachings</strong> about soul evolution through the kingdoms of nature. This sacred number represents 
                        the complete journey from mineral consciousness to Moksha (liberation).
                    </p>
                    <p style="margin-top: 15px; line-height: 1.8; color: #4B5563;">
                        According to the <em>Yoga Vashishtha</em> and Helena Blavatsky's <em>Secret Doctrine</em>, souls progress through 
                        seven major cycles (Manvantaras), each containing 111 incarnations, totaling the mystical 777.
                    </p>
                </div>

                <div class="wisdom-card">
                    <div class="wisdom-header">
                        <span>🔢</span>
                        <span>Understanding Your Numbers</span>
                    </div>
                    <ul style="line-height: 2; color: #4B5563; list-style: none; padding-left: 0;">
                        <li>📊 <strong>Soul Age Number:</strong> Your current incarnation count (1-777)</li>
                        <li>🌍 <strong>Earth Years:</strong> Approximate time spent in physical evolution (165 years between incarnations)</li>
                        <li>🌀 <strong>Spiral Level:</strong> Which of the 7 major evolutionary cycles you're in</li>
                        <li>🎯 <strong>Lives to Liberation:</strong> Remaining incarnations before potential Moksha</li>
                        <li>💫 <strong>Karmic Density:</strong> How much karma you're processing in this lifetime</li>
                    </ul>
                </div>

                <div class="wisdom-card">
                    <div class="wisdom-header">
                        <span>👤</span>
                        <span>Who Should Use This Calculator?</span>
                    </div>
                    <ul style="line-height: 2; color: #4B5563; list-style: none; padding-left: 0;">
                        <li>✓ Spiritual seekers exploring their evolutionary journey</li>
                        <li>✓ Students of Vedanta, Theosophy, and Eastern philosophy</li>
                        <li>✓ Those experiencing spiritual awakening or kundalini activation</li>
                        <li>✓ Individuals seeking to understand their life purpose and dharma</li>
                        <li>✓ Practitioners wanting to align with their soul's development stage</li>
                    </ul>
                </div>

                <div class="wisdom-card">
                    <div class="wisdom-header">
                        <span>🎁</span>
                        <span>Benefits of Knowing Your Soul Age</span>
                    </div>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 15px; margin-top: 15px;">
                        <div style="padding: 15px; background: white; border-radius: 10px;">
                            <strong style="color: var(--primary);">🧘 Spiritual Practice</strong>
                            <p style="margin-top: 8px; font-size: 0.95rem; color: #6B7280;">
                                Receive practices aligned with your soul's development stage
                            </p>
                        </div>
                        <div style="padding: 15px; background: white; border-radius: 10px;">
                            <strong style="color: var(--primary);">💝 Relationships</strong>
                            <p style="margin-top: 8px; font-size: 0.95rem; color: #6B7280;">
                                Understand karmic connections and soul contracts
                            </p>
                        </div>
                        <div style="padding: 15px; background: white; border-radius: 10px;">
                            <strong style="color: var(--primary);">🎯 Life Purpose</strong>
                            <p style="margin-top: 8px; font-size: 0.95rem; color: #6B7280;">
                                Clarity on your dharma and soul mission
                            </p>
                        </div>
                        <div style="padding: 15px; background: white; border-radius: 10px;">
                            <strong style="color: var(--primary);">🔮 Shadow Work</strong>
                            <p style="margin-top: 8px; font-size: 0.95rem; color: #6B7280;">
                                Identify karmic patterns requiring healing
                            </p>
                        </div>
                    </div>
                </div>

                <h3 style="color: var(--primary); margin: 30px 0 20px; font-size: 1.4rem; text-align: center;">
                    The Seven Stages of Soul Evolution
                </h3>

                <div class="evolution-stages">
                    <div class="stage-card" data-range="1-111">
                        <div class="stage-header">
                            <span class="stage-range">1-111 Incarnations</span>
                        </div>
                        <div class="stage-title">🏔️ Mineral & Elemental Kingdom</div>
                        <div class="stage-description">
                            <strong>Vedantic Stage:</strong> Achit (Non-conscious) • <strong>Theosophical:</strong> First Elemental Kingdom<br>
                            <strong>Learning:</strong> Basic existence, crystalline consciousness, elemental forces<br>
                            <strong>Chakra:</strong> Below Root (Earth Star) • <strong>Element:</strong> Prithvi (Earth)
                        </div>
                    </div>

                    <div class="stage-card" data-range="112-222">
                        <div class="stage-header">
                            <span class="stage-range">112-222 Incarnations</span>
                        </div>
                        <div class="stage-title">🌱 Plant Kingdom</div>
                        <div class="stage-description">
                            <strong>Vedantic Stage:</strong> Prana-maya (Life sheath) • <strong>Theosophical:</strong> Second Kingdom<br>
                            <strong>Learning:</strong> Growth, photosynthesis consciousness, seasonal cycles<br>
                            <strong>Chakra:</strong> Root (Muladhara) • <strong>Element:</strong> Apas (Water)
                        </div>
                    </div>

                    <div class="stage-card" data-range="223-333">
                        <div class="stage-header">
                            <span class="stage-range">223-333 Incarnations</span>
                        </div>
                        <div class="stage-title">🦁 Animal Kingdom</div>
                        <div class="stage-description">
                            <strong>Vedantic Stage:</strong> Mano-maya (Mind sheath) • <strong>Theosophical:</strong> Third Kingdom<br>
                            <strong>Learning:</strong> Instinct, emotion, pack consciousness, survival<br>
                            <strong>Chakra:</strong> Sacral (Svadhisthana) • <strong>Element:</strong> Tejas (Fire)
                        </div>
                    </div>

                    <div class="stage-card" data-range="334-444">
                        <div class="stage-header">
                            <span class="stage-range">334-444 Incarnations</span>
                        </div>
                        <div class="stage-title">👶 Young Human Souls</div>
                        <div class="stage-description">
                            <strong>Vedantic Stage:</strong> Vijnana-maya (Intellect sheath) • <strong>Theosophical:</strong> Fourth Kingdom<br>
                            <strong>Learning:</strong> Individual identity, material mastery, ego development<br>
                            <strong>Chakra:</strong> Solar Plexus (Manipura) • <strong>Element:</strong> Vayu (Air)<br>
                            <strong>Focus:</strong> "What can I achieve?" - Building personal power and success
                        </div>
                    </div>

                    <div class="stage-card" data-range="445-555">
                        <div class="stage-header">
                            <span class="stage-range">445-555 Incarnations</span>
                        </div>
                        <div class="stage-title">💗 Mature Human Souls</div>
                        <div class="stage-description">
                            <strong>Vedantic Stage:</strong> Ananda-maya (Bliss sheath) • <strong>Theosophical:</strong> Advanced Fourth Kingdom<br>
                            <strong>Learning:</strong> Emotional depth, relationships, empathy, heart opening<br>
                            <strong>Chakra:</strong> Heart (Anahata) • <strong>Element:</strong> Akasha (Ether)<br>
                            <strong>Focus:</strong> "How do you feel?" - Deep connections and emotional mastery
                        </div>
                    </div>

                    <div class="stage-card" data-range="556-666">
                        <div class="stage-header">
                            <span class="stage-range">556-666 Incarnations</span>
                        </div>
                        <div class="stage-title">🧙 Old Human Souls</div>
                        <div class="stage-description">
                            <strong>Vedantic Stage:</strong> Approaching Jivanmukti • <strong>Theosophical:</strong> Approaching Fifth Kingdom<br>
                            <strong>Learning:</strong> Wisdom integration, teaching, detachment, service<br>
                            <strong>Chakra:</strong> Throat & Third Eye (Vishuddha & Ajna) • <strong>Element:</strong> Mind<br>
                            <strong>Focus:</strong> "What is truth?" - Spiritual teaching and wisdom sharing
                        </div>
                    </div>

                    <div class="stage-card" data-range="667-777" style="border-color: var(--sacred-gold); background: linear-gradient(135deg, rgba(255, 215, 0, 0.1), rgba(255, 255, 255, 1));">
                        <div class="stage-header">
                            <span class="stage-range" style="background: var(--sacred-gold); color: var(--text);">667-777 Incarnations</span>
                        </div>
                        <div class="stage-title">👑 Transcendent Souls (Siddhas)</div>
                        <div class="stage-description">
                            <strong>Vedantic Stage:</strong> Jivanmukta (Liberated) • <strong>Theosophical:</strong> Fifth Kingdom (Masters)<br>
                            <strong>Learning:</strong> Final integration, bodhisattva vows, cosmic consciousness<br>
                            <strong>Chakra:</strong> Crown & Above (Sahasrara) • <strong>Element:</strong> Pure Consciousness<br>
                            <strong>Focus:</strong> "How can I serve?" - Universal compassion and liberation of all beings<br>
                            <em style="color: var(--sacred-gold);">These souls often become Ascended Masters, Rishis, or Bodhisattvas</em>
                        </div>
                    </div>
                </div>

                <div class="wisdom-card" style="margin-top: 30px; background: linear-gradient(135deg, rgba(255, 215, 0, 0.1), rgba(255, 255, 255, 1));">
                    <div class="wisdom-header">
                        <span>⚡</span>
                        <span>Accelerating Your Evolution</span>
                    </div>
                    <p style="line-height: 1.8; color: #4B5563;">
                        While the 777-incarnation journey is the natural progression, certain practices can accelerate soul evolution:
                    </p>
                    <ul style="margin-top: 15px; line-height: 2; color: #4B5563;">
                        <li>🧘 <strong>Raja Yoga:</strong> Direct path to samadhi and liberation</li>
                        <li>📿 <strong>Bhakti Yoga:</strong> Devotional practices that dissolve ego</li>
                        <li>📖 <strong>Jnana Yoga:</strong> Self-inquiry and wisdom cultivation</li>
                        <li>🤲 <strong>Karma Yoga:</strong> Selfless service accelerating karmic resolution</li>
                        <li>🔥 <strong>Kundalini Awakening:</strong> Can advance soul age by multiple lifetimes</li>
                        <li>💎 <strong>Initiation:</strong> Connection with enlightened masters</li>
                    </ul>
                </div>
            </div>
        </div>

        <!-- Tabs 3 & 4 will be in Part 2 -->
<!-- Tab 3: Jaimini Analysis -->
<div id="jaimini-tab" class="tab-content">
<div class="section">
<div class="section-header">
<span class="section-icon">🔮</span>
<h2 class="section-title">Jaimini Astrological Analysis</h2>
</div>

<div class="wisdom-card">
<div class="wisdom-header">
<span>📜</span>
<span>Understanding Jaimini System</span>
</div>
<p style="line-height: 1.8; color: #4B5563;">
<strong>Maharishi Jaimini's</strong> astrological system, distinct from Parashari astrology, focuses on the soul's journey through 
<em>Chara Karakas</em> (soul significators) and <em>Atmakaraka</em> (the soul's desire). This system reveals your soul's deepest 
lessons and karmic debts across incarnations.
</p>
</div>

<!-- Jaimini vs Parashari Comparison -->
<div class="comparison-table" style="margin: 30px 0;">
<h3 style="color: var(--primary); margin-bottom: 20px; text-align: center;">
Jaimini vs. Parashari Systems
</h3>
<div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px;">
<div style="background: linear-gradient(135deg, #F3F4F6, white); padding: 20px; border-radius: 15px;">
<h4 style="color: var(--primary); margin-bottom: 15px;">🏛️ Jaimini System</h4>
<ul style="list-style: none; padding: 0; line-height: 2;">
<li>✓ Focus on soul evolution & spiritual purpose</li>
<li>✓ Uses Chara (moveable) Karakas</li>
<li>✓ Atmakaraka reveals soul's desire</li>
<li>✓ Karakamsha for liberation path</li>
<li>✓ Chara Dasha for soul timing</li>
<li>✓ Emphasizes moksha & dharma</li>
</ul>
</div>
<div style="background: linear-gradient(135deg, #F3F4F6, white); padding: 20px; border-radius: 15px;">
<h4 style="color: var(--secondary); margin-bottom: 15px;">📊 Parashari System</h4>
<ul style="list-style: none; padding: 0; line-height: 2;">
<li>✓ Focus on material life & psychology</li>
<li>✓ Uses fixed Karakas</li>
<li>✓ Lagna for personality</li>
<li>✓ House system for life areas</li>
<li>✓ Vimshottari Dasha for timing</li>
<li>✓ Emphasizes all four purusharthas</li>
</ul>
</div>
</div>
</div>

<!-- Chara Karakas Display -->
<div id="charaKarakas" style="display: none;">
<h3 style="color: var(--primary); margin: 30px 0 20px; text-align: center;">
Your Chara Karakas (Soul Significators)
</h3>

<div class="karakas-grid" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 20px; margin-bottom: 30px;">
<!-- Atmakaraka -->
<div class="karaka-card" style="background: linear-gradient(135deg, rgba(255, 215, 0, 0.1), white); border: 2px solid var(--sacred-gold); padding: 20px; border-radius: 15px;">
<h4 style="color: var(--sacred-gold); margin-bottom: 10px;">👑 Atmakaraka (AK)</h4>
<div id="atmakaraka-planet" style="font-size: 1.2rem; font-weight: bold; margin-bottom: 10px;">Sun ☉</div>
<p style="color: #6B7280; line-height: 1.6;">
<strong>Soul's Desire:</strong> <span id="ak-desire">Leadership & self-realization</span><br>
<strong>Karmic Lesson:</strong> <span id="ak-lesson">Transcending ego</span><br>
<strong>Liberation Path:</strong> <span id="ak-path">Through service & humility</span>
</p>
</div>

<!-- Amatya Karaka -->
<div class="karaka-card" style="background: #F9FAFB; padding: 20px; border-radius: 15px; border-left: 4px solid var(--primary);">
<h4 style="color: var(--primary); margin-bottom: 10px;">💼 Amatyakaraka (AmK)</h4>
<div id="amatya-planet" style="font-size: 1.1rem; font-weight: bold; margin-bottom: 10px;">Mercury ☿</div>
<p style="color: #6B7280; line-height: 1.6;">
<strong>Career/Calling:</strong> <span id="amk-career">Teaching & communication</span><br>
<strong>Support System:</strong> <span id="amk-support">Intellectual peers</span>
</p>
</div>

<!-- Bhratri Karaka -->
<div class="karaka-card" style="background: #F9FAFB; padding: 20px; border-radius: 15px; border-left: 4px solid var(--primary);">
<h4 style="color: var(--primary); margin-bottom: 10px;">🤝 Bhratrikaraka (BK)</h4>
<div id="bhratri-planet" style="font-size: 1.1rem; font-weight: bold; margin-bottom: 10px;">Mars ♂</div>
<p style="color: #6B7280; line-height: 1.6;">
<strong>Siblings/Courage:</strong> <span id="bk-siblings">Strong warrior spirit</span><br>
<strong>Initiative:</strong> <span id="bk-initiative">Bold action-taker</span>
</p>
</div>

<!-- Matri Karaka -->
<div class="karaka-card" style="background: #F9FAFB; padding: 20px; border-radius: 15px; border-left: 4px solid var(--primary);">
<h4 style="color: var(--primary); margin-bottom: 10px;">🏠 Matrikaraka (MK)</h4>
<div id="matri-planet" style="font-size: 1.1rem; font-weight: bold; margin-bottom: 10px;">Moon ☽</div>
<p style="color: #6B7280; line-height: 1.6;">
<strong>Mother/Nurturing:</strong> <span id="mk-mother">Deep emotional bonds</span><br>
<strong>Comfort Zone:</strong> <span id="mk-comfort">Home & family</span>
</p>
</div>

<!-- Putra Karaka -->
<div class="karaka-card" style="background: #F9FAFB; padding: 20px; border-radius: 15px; border-left: 4px solid var(--primary);">
<h4 style="color: var(--primary); margin-bottom: 10px;">👶 Putrakaraka (PK)</h4>
<div id="putra-planet" style="font-size: 1.1rem; font-weight: bold; margin-bottom: 10px;">Jupiter ♃</div>
<p style="color: #6B7280; line-height: 1.6;">
<strong>Children/Creativity:</strong> <span id="pk-children">Wisdom teachings</span><br>
<strong>Intelligence:</strong> <span id="pk-intelligence">Philosophical mind</span>
</p>
</div>

<!-- Gnati Karaka -->
<div class="karaka-card" style="background: #F9FAFB; padding: 20px; border-radius: 15px; border-left: 4px solid var(--primary);">
<h4 style="color: var(--primary); margin-bottom: 10px;">⚔️ Gnatikaraka (GK)</h4>
<div id="gnati-planet" style="font-size: 1.1rem; font-weight: bold; margin-bottom: 10px;">Saturn ♄</div>
<p style="color: #6B7280; line-height: 1.6;">
<strong>Obstacles/Enemies:</strong> <span id="gk-obstacles">Karmic delays</span><br>
<strong>Disease:</strong> <span id="gk-disease">Chronic conditions</span>
</p>
</div>

<!-- Dara Karaka -->
<div class="karaka-card" style="background: #F9FAFB; padding: 20px; border-radius: 15px; border-left: 4px solid var(--primary);">
<h4 style="color: var(--primary); margin-bottom: 10px;">💑 Darakaraka (DK)</h4>
<div id="dara-planet" style="font-size: 1.1rem; font-weight: bold; margin-bottom: 10px;">Venus ♀</div>
<p style="color: #6B7280; line-height: 1.6;">
<strong>Spouse/Partners:</strong> <span id="dk-spouse">Artistic & loving</span><br>
<strong>Relationships:</strong> <span id="dk-relationships">Harmony seeking</span>
</p>
</div>
</div>

<!-- Karakamsha Analysis -->
<div class="wisdom-card">
<div class="wisdom-header">
<span>🎯</span>
<span>Karakamsha Lagna Analysis</span>
</div>
<div id="karakamsha-analysis" style="margin-top: 15px;">
<p style="line-height: 1.8; color: #4B5563;">
Your <strong>Karakamsha</strong> (the Navamsa position of your Atmakaraka) reveals your soul's ultimate destination 
and the path to liberation. Based on your calculations:
</p>
<ul style="margin-top: 15px; line-height: 2; color: #4B5563;">
<li>📍 <strong>Karakamsha Sign:</strong> <span id="karakamsha-sign">Sagittarius</span></li>
<li>🏛️ <strong>Liberation Path:</strong> <span id="liberation-path">Through wisdom & teaching</span></li>
<li>🔮 <strong>Ishta Devata:</strong> <span id="ishta-devata">Lord Vishnu/Krishna</span></li>
<li>🕉️ <strong>Spiritual Practice:</strong> <span id="spiritual-practice">Bhakti & Jnana Yoga</span></li>
</ul>
</div>
</div>

<!-- Chara Dasha Periods -->
<div class="wisdom-card">
<div class="wisdom-header">
<span>⏰</span>
<span>Current Chara Dasha Period</span>
</div>
<div id="chara-dasha" style="margin-top: 15px;">
<p style="line-height: 1.8; color: #4B5563;">
<strong>Current Dasha:</strong> <span id="current-dasha">Scorpio Dasha</span><br>
<strong>Period:</strong> <span id="dasha-period">2020-2027</span><br>
<strong>Theme:</strong> <span id="dasha-theme">Deep transformation & occult wisdom</span><br>
<strong>Soul Lesson:</strong> <span id="dasha-lesson">Embracing death & rebirth cycles</span>
</p>
</div>
</div>

<!-- Jaimini Remedies -->
<div class="wisdom-card" style="background: linear-gradient(135deg, rgba(107, 70, 193, 0.05), white);">
<div class="wisdom-header">
<span>💎</span>
<span>Jaimini Remedial Measures</span>
</div>
<div id="jaimini-remedies" style="margin-top: 15px;">
<ul style="line-height: 2; color: #4B5563;">
<li>🕉️ <strong>Mantra:</strong> <span id="remedy-mantra">Om Namo Narayanaya</span></li>
<li>💎 <strong>Gemstone:</strong> <span id="remedy-gem">Yellow Sapphire</span></li>
<li>🎨 <strong>Color:</strong> <span id="remedy-color">Saffron & Gold</span></li>
<li>📅 <strong>Fast Day:</strong> <span id="remedy-fast">Thursdays</span></li>
<li>🙏 <strong>Deity Worship:</strong> <span id="remedy-deity">Lord Vishnu</span></li>
<li>🌸 <strong>Charity:</strong> <span id="remedy-charity">Donate yellow items to Brahmins</span></li>
</ul>
</div>
</div>
</div>

<!-- Calculate Jaimini Button -->
<button class="calculate-btn" id="calculateJaiminiBtn" style="margin-top: 30px;">
🔮 Generate My Jaimini Chart
</button>
</div>
</div>

<!-- Tab 4: Spiritual Guidance -->
<div id="guidance-tab" class="tab-content">
<div class="section">
<div class="section-header">
<span class="section-icon">🧘</span>
<h2 class="section-title">Personalized Spiritual Guidance</h2>
</div>

<div id="guidanceContent" style="display: none;">
<!-- Soul Ray & Group -->
<div class="wisdom-card" style="background: linear-gradient(135deg, rgba(255, 215, 0, 0.1), white);">
<div class="wisdom-header">
<span>✨</span>
<span>Soul Ray & Spiritual Group</span>
</div>
<div style="margin-top: 15px;">
<div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px;">
<div>
<h4 style="color: var(--primary); margin-bottom: 10px;">Primary Soul Ray</h4>
<div id="soul-ray" style="font-size: 1.2rem; font-weight: bold; color: var(--sacred-gold);">
Ray 2 - Love/Wisdom
</div>
<p style="margin-top: 5px; color: #6B7280; font-size: 0.9rem;">
Teaching through compassion
</p>
</div>
<div>
<h4 style="color: var(--primary); margin-bottom: 10px;">Soul Group</h4>
<div id="soul-group" style="font-size: 1.2rem; font-weight: bold; color: var(--sacred-gold);">
Blue Ray Healers
</div>
<p style="margin-top: 5px; color: #6B7280; font-size: 0.9rem;">
Healing humanity's consciousness
</p>
</div>
<div>
<h4 style="color: var(--primary); margin-bottom: 10px;">Monadic Family</h4>
<div id="monadic-family" style="font-size: 1.2rem; font-weight: bold; color: var(--sacred-gold);">
144 Soul Extension
</div>
<p style="margin-top: 5px; color: #6B7280; font-size: 0.9rem;">
Part of 144,000 lightworkers
</p>
</div>
</div>
</div>
</div>

<!-- Past Life Themes -->
<div class="wisdom-card">
<div class="wisdom-header">
<span>🔄</span>
<span>Dominant Past Life Themes</span>
</div>
<div id="past-life-themes" style="margin-top: 15px;">
<div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 15px;">
<div style="padding: 15px; background: white; border-radius: 10px; border-left: 4px solid var(--primary);">
<strong style="color: var(--primary);">🏛️ Ancient Mystery Schools</strong>
<p style="margin-top: 8px; color: #6B7280; font-size: 0.95rem;">
Initiate in Egyptian, Greek, and Indian temples
</p>
</div>
<div style="padding: 15px; background: white; border-radius: 10px; border-left: 4px solid var(--primary);">
<strong style="color: var(--primary);">👑 Leadership Roles</strong>
<p style="margin-top: 8px; color: #6B7280; font-size: 0.95rem;">
Priest-kings, spiritual advisors, teachers
</p>
</div>
<div style="padding: 15px; background: white; border-radius: 10px; border-left: 4px solid var(--primary);">
<strong style="color: var(--primary);">🧙 Mystic & Healer</strong>
<p style="margin-top: 8px; color: #6B7280; font-size: 0.95rem;">
Shamanic traditions, energy healing mastery
</p>
</div>
</div>
</div>
</div>

<!-- Karmic Debt Calculator -->
<div class="wisdom-card">
<div class="wisdom-header">
<span>⚖️</span>
<span>Karmic Debt Analysis</span>
</div>
<div style="margin-top: 20px;">
<div style="background: linear-gradient(90deg, #10B981 0%, #10B981 65%, #F3F4F6 65%); height: 30px; border-radius: 15px; position: relative;">
<div style="position: absolute; left: 65%; top: 50%; transform: translate(-50%, -50%); background: white; padding: 5px 10px; border-radius: 10px; font-weight: bold;">
65% Resolved
</div>
</div>
<div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-top: 20px;">
<div>
<strong style="color: var(--success);">✓ Resolved Karma</strong>
<ul style="margin-top: 8px; color: #6B7280; font-size: 0.9rem; list-style: none; padding: 0;">
<li>• Power misuse lessons</li>
<li>• Family karma healing</li>
<li>• Poverty consciousness</li>
</ul>
</div>
<div>
<strong style="color: var(--warning);">⏳ Active Karma</strong>
<ul style="margin-top: 8px; color: #6B7280; font-size: 0.9rem; list-style: none; padding: 0;">
<li>• Relationship patterns</li>
<li>• Self-worth issues</li>
<li>• Service vs. martyrdom</li>
</ul>
</div>
</div>
</div>
</div>

<!-- Spiritual Gifts Timeline -->
<div class="wisdom-card">
<div class="wisdom-header">
<span>🎁</span>
<span>Spiritual Gifts Activation Timeline</span>
</div>
<div style="margin-top: 20px;">
<div style="position: relative; padding-left: 30px;">
<div style="position: absolute; left: 10px; top: 0; bottom: 0; width: 2px; background: var(--primary);"></div>

<div style="position: relative; margin-bottom: 20px;">
<div style="position: absolute; left: -25px; width: 12px; height: 12px; background: var(--success); border-radius: 50%;"></div>
<strong>Age 7-14:</strong> Intuitive abilities awakening
</div>
<div style="position: relative; margin-bottom: 20px;">
<div style="position: absolute; left: -25px; width: 12px; height: 12px; background: var(--success); border-radius: 50%;"></div>
<strong>Age 21-28:</strong> Healing abilities activation
</div>
<div style="position: relative; margin-bottom: 20px;">
<div style="position: absolute; left: -25px; width: 12px; height: 12px; background: var(--warning); border-radius: 50%;"></div>
<strong>Age 35-42:</strong> Teaching & wisdom transmission
</div>
<div style="position: relative; margin-bottom: 20px;">
<div style="position: absolute; left: -25px; width: 12px; height: 12px; background: #E5E7EB; border-radius: 50%;"></div>
<strong>Age 49-56:</strong> Mastery & integration phase
</div>
<div style="position: relative;">
<div style="position: absolute; left: -25px; width: 12px; height: 12px; background: #E5E7EB; border-radius: 50%;"></div>
<strong>Age 63+:</strong> Elder wisdom & legacy creation
</div>
</div>
</div>
</div>

<!-- Life Purpose & Career -->
<div class="wisdom-card">
<div class="wisdom-header">
<span>🎯</span>
<span>Life Purpose & Dharmic Career Paths</span>
</div>
<div style="margin-top: 15px;">
<h4 style="color: var(--primary); margin-bottom: 10px;">Core Life Purpose</h4>
<p id="life-purpose" style="padding: 15px; background: white; border-radius: 10px; line-height: 1.8;">
To serve as a bridge between ancient wisdom and modern consciousness, helping humanity remember its divine nature 
through teaching, healing, and embodying unconditional love.
</p>

<h4 style="color: var(--primary); margin: 20px 0 10px;">Aligned Career Paths</h4>
<div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 10px;">
<div style="padding: 10px; background: #F9FAFB; border-radius: 8px;">
✓ Spiritual Teacher/Guide
</div>
<div style="padding: 10px; background: #F9FAFB; border-radius: 8px;">
✓ Energy Healer/Therapist
</div>
<div style="padding: 10px; background: #F9FAFB; border-radius: 8px;">
✓ Consciousness Researcher
</div>
<div style="padding: 10px; background: #F9FAFB; border-radius: 8px;">
✓ Sacred Space Designer
</div>
<div style="padding: 10px; background: #F9FAFB; border-radius: 8px;">
✓ Meditation Instructor
</div>
<div style="padding: 10px; background: #F9FAFB; border-radius: 8px;">
✓ Holistic Counselor
</div>
</div>
</div>
</div>

<!-- Soul Compatibility -->
<div class="wisdom-card">
<div class="wisdom-header">
<span>💝</span>
<span>Soul Age Compatibility Guide</span>
</div>
<div style="margin-top: 15px;">
<div style="display: grid; gap: 15px;">
<div style="padding: 15px; background: linear-gradient(135deg, #10B98120, white); border-radius: 10px;">
<strong style="color: var(--success);">🟢 Highly Compatible Soul Ages</strong>
<p style="margin-top: 8px; color: #6B7280;">
Souls within 111 incarnations of your age. Deep understanding, shared wisdom, effortless connection.
</p>
</div>
<div style="padding: 15px; background: linear-gradient(135deg, #F59E0B20, white); border-radius: 10px;">
<strong style="color: var(--warning);">🟡 Growth-Oriented Matches</strong>
<p style="margin-top: 8px; color: #6B7280;">
Souls 112-222 incarnations different. Mutual learning, karmic resolution, transformative relationships.
</p>
</div>
<div style="padding: 15px; background: linear-gradient(135deg, #EF444420, white); border-radius: 10px;">
<strong style="color: var(--error);">🔴 Challenging Connections</strong>
<p style="margin-top: 8px; color: #6B7280;">
Souls 333+ incarnations apart. Teacher-student dynamics, patience required, significant growth potential.
</p>
</div>
</div>
</div>
</div>

<!-- Shadow Work -->
<div class="wisdom-card">
<div class="wisdom-header">
<span>🌑</span>
<span>Shadow Work for Your Soul Stage</span>
</div>
<div id="shadow-work" style="margin-top: 15px;">
<div style="display: grid; gap: 15px;">
<div>
<strong style="color: var(--primary);">Primary Shadow Patterns</strong>
<ul style="margin-top: 10px; line-height: 2; color: #6B7280;">
<li>• Spiritual superiority or bypassing</li>
<li>• Difficulty with boundaries in service</li>
<li>• Attachment to being "special" or "chosen"</li>
<li>• Impatience with "slower" souls</li>
</ul>
</div>
<div>
<strong style="color: var(--primary);">Integration Practices</strong>
<ul style="margin-top: 10px; line-height: 2; color: #6B7280;">
<li>• Daily humility meditation</li>
<li>• Inner child healing work</li>
<li>• Shadow journaling practice</li>
<li>• Conscious ego dissolution</li>
</ul>
</div>
</div>
</div>
</div>

<!-- Ascension Symptoms -->
<div class="wisdom-card">
<div class="wisdom-header">
<span>⚡</span>
<span>Current Ascension Symptoms</span>
</div>
<div style="margin-top: 15px;">
<p style="color: #6B7280; margin-bottom: 15px;">
Based on your soul age and current planetary energies, you may be experiencing:
</p>
<div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 10px;">
<div style="padding: 10px; background: #F9FAFB; border-radius: 8px; border-left: 3px solid var(--primary);">
🧠 Crown pressure/tingling
</div>
<div style="padding: 10px; background: #F9FAFB; border-radius: 8px; border-left: 3px solid var(--primary);">
👁️ Third eye activation
</div>
<div style="padding: 10px; background: #F9FAFB; border-radius: 8px; border-left: 3px solid var(--primary);">
💫 Timeline shifting
</div>
<div style="padding: 10px; background: #F9FAFB; border-radius: 8px; border-left: 3px solid var(--primary);">
🌙 Vivid spiritual dreams
</div>
<div style="padding: 10px; background: #F9FAFB; border-radius: 8px; border-left: 3px solid var(--primary);">
⚡ Energy surges
</div>
<div style="padding: 10px; background: #F9FAFB; border-radius: 8px; border-left: 3px solid var(--primary);">
🎭 Reality perception shifts
</div>
</div>
</div>
</div>

<!-- Sacred Geometry & Chakras -->
<div class="wisdom-card">
<div class="wisdom-header">
<span>🔷</span>
<span>Sacred Geometry & Chakra Activation</span>
</div>
<div style="margin-top: 15px;">
<div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px;">
<div>
<h4 style="color: var(--primary); margin-bottom: 10px;">Sacred Geometry Pattern</h4>
<div style="text-align: center; padding: 20px; background: white; border-radius: 10px;">
<div style="font-size: 3rem;">✡️</div>
<strong>Merkaba</strong>
<p style="margin-top: 10px; color: #6B7280; font-size: 0.9rem;">
Light body vehicle for interdimensional travel
</p>
</div>
</div>
<div>
<h4 style="color: var(--primary); margin-bottom: 10px;">Active Chakras</h4>
<div style="padding: 15px; background: white; border-radius: 10px;">
<div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
<span>Crown</span>
<div style="width: 100px; height: 10px; background: linear-gradient(90deg, #9333EA 0%, #9333EA 95%, #F3F4F6 95%); border-radius: 5px;"></div>
<span>95%</span>
</div>
<div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
<span>Third Eye</span>
<div style="width: 100px; height: 10px; background: linear-gradient(90deg, #6366F1 0%, #6366F1 88%, #F3F4F6 88%); border-radius: 5px;"></div>
<span>88%</span>
</div>
<div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
<span>Throat</span>
<div style="width: 100px; height: 10px; background: linear-gradient(90deg, #0EA5E9 0%, #0EA5E9 75%, #F3F4F6 75%); border-radius: 5px;"></div>
<span>75%</span>
</div>
<div style="display: flex; justify-content: space-between; align-items: center;">
<span>Heart</span>
<div style="width: 100px; height: 10px; background: linear-gradient(90deg, #10B981 0%, #10B981 92%, #F3F4F6 92%); border-radius: 5px;"></div>
<span>92%</span>
</div>
</div>
</div>
</div>
</div>
</div>

<!-- Color Therapy -->
<div class="wisdom-card">
<div class="wisdom-header">
<span>🎨</span>
<span>Color Therapy for Your Soul Age</span>
</div>
<div style="margin-top: 15px;">
<div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 15px; text-align: center;">
<div>
<div style="width: 60px; height: 60px; background: #8B5CF6; border-radius: 50%; margin: 0 auto 10px;"></div>
<strong>Violet</strong>
<p style="font-size: 0.85rem; color: #6B7280; margin-top: 5px;">Transmutation</p>
</div>
<div>
<div style="width: 60px; height: 60px; background: #3B82F6; border-radius: 50%; margin: 0 auto 10px;"></div>
<strong>Indigo</strong>
<p style="font-size: 0.85rem; color: #6B7280; margin-top: 5px;">Inner Vision</p>
</div>
<div>
<div style="width: 60px; height: 60px; background: #10B981; border-radius: 50%; margin: 0 auto 10px;"></div>
<strong>Emerald</strong>
<p style="font-size: 0.85rem; color: #6B7280; margin-top: 5px;">Heart Healing</p>
</div>
<div>
<div style="width: 60px; height: 60px; background: #FFD700; border-radius: 50%; margin: 0 auto 10px;"></div>
<strong>Gold</strong>
<p style="font-size: 0.85rem; color: #6B7280; margin-top: 5px;">Divine Connection</p>
</div>
</div>
<p style="margin-top: 20px; padding: 15px; background: white; border-radius: 10px; color: #6B7280;">
<strong>Daily Practice:</strong> Visualize these colors flowing through your aura during meditation. 
Wear these colors or place them in your environment to accelerate spiritual development.
</p>
</div>
</div>

<!-- Personalized Practices -->
<div class="wisdom-card" style="background: linear-gradient(135deg, rgba(107, 70, 193, 0.05), white);">
<div class="wisdom-header">
<span>🕉️</span>
<span>Your Personalized Spiritual Practices</span>
</div>
<div style="margin-top: 20px;">
<div style="display: grid; gap: 15px;">
<div style="padding: 15px; background: white; border-radius: 10px;">
<strong style="color: var(--primary);">🌅 Morning Practice (20 mins)</strong>
<ol style="margin-top: 10px; line-height: 2; color: #6B7280;">
<li>1. Gayatri Mantra (108 times)</li>
<li>2. Heart Chakra breathing</li>
<li>3. Violet flame meditation</li>
<li>4. Setting daily intention</li>
</ol>
</div>
<div style="padding: 15px; background: white; border-radius: 10px;">
<strong style="color: var(--primary);">🌙 Evening Practice (15 mins)</strong>
<ol style="margin-top: 10px; line-height: 2; color: #6B7280;">
<li>1. Karma clearing visualization</li>
<li>2. Gratitude journaling</li>
<li>3. Third eye activation</li>
<li>4. Astral preparation meditation</li>
</ol>
</div>
<div style="padding: 15px; background: white; border-radius: 10px;">
<strong style="color: var(--primary);">📅 Weekly Practices</strong>
<ul style="margin-top: 10px; line-height: 2; color: #6B7280; list-style: none; padding: 0;">
<li>• Monday: Fasting & purification</li>
<li>• Wednesday: Sacred study (Vedanta/Theosophy)</li>
<li>• Friday: Service & karma yoga</li>
<li>• Sunday: Nature connection & grounding</li>
</ul>
</div>
</div>
</div>
</div>
</div>

<!-- Generate Guidance Button -->
<button class="calculate-btn" id="generateGuidanceBtn" style="margin-top: 30px;">
✨ Generate My Spiritual Guidance
</button>
</div>
</div>

<!-- Additional JavaScript for Jaimini and Guidance tabs -->
<script>
// Extend the existing JavaScript with these functions
(function() {
    'use strict';
    
    // Prevent clickjacking
    if (top !== self) {
        top.location = self.location;
    }
    
    // Disable right-click in production
    if (window.location.hostname !== 'localhost' && window.location.hostname !== '127.0.0.1') {
        document.addEventListener('contextmenu', function(e) {
            e.preventDefault();
            return false;
        });
    }
    
    // Prevent console access in production
    if (window.location.hostname !== 'localhost') {
        console.log = function() {};
        console.warn = function() {};
        console.error = function() {};
    }
    
    // Set secure cookie attributes if any cookies are used
    document.cookie = "SameSite=Strict; Secure";
})();
    
// Jaimini Analysis Functions
document.getElementById('calculateJaiminiBtn').addEventListener('click', () => {
if (!AppState.calculationResults) {
alert('Please calculate your soul age first in the Calculate tab.');
return;
}

generateJaiminiAnalysis();
});

function generateJaiminiAnalysis() {
// Show loading effect
document.getElementById('charaKarakas').style.display = 'none';

setTimeout(() => {
// Generate Chara Karakas based on birth data
const karakas = calculateCharaKarakas();
displayCharaKarakas(karakas);

// Show the analysis
document.getElementById('charaKarakas').style.display = 'block';
document.getElementById('charaKarakas').scrollIntoView({ behavior: 'smooth' });
}, 1500);
}

function calculateCharaKarakas() {
const { date, hour, minute } = AppState.birthData;
const soulAge = AppState.calculationResults.soulAge;

// Simulated Jaimini calculations based on soul age and birth data
const planets = ['Sun', 'Moon', 'Mars', 'Mercury', 'Jupiter', 'Venus', 'Saturn'];
const shuffled = planets.sort(() => 0.5 - Math.random());

const karakaData = {
atmakaraka: {
planet: shuffled[0],
symbol: getPlanetSymbol(shuffled[0]),
desire: getAtmakarakaDesire(shuffled[0]),
lesson: getAtmakarakaLesson(shuffled[0]),
path: getAtmakarakaPath(shuffled[0])
},
amatya: {
planet: shuffled[1],
symbol: getPlanetSymbol(shuffled[1]),
career: getAmatyaCareer(shuffled[1]),
support: getAmatyaSupport(shuffled[1])
},
bhratri: {
planet: shuffled[2],
symbol: getPlanetSymbol(shuffled[2]),
siblings: getBhratriTraits(shuffled[2]),
initiative: getBhratriInitiative(shuffled[2])
},
matri: {
planet: shuffled[3],
symbol: getPlanetSymbol(shuffled[3]),
mother: getMatriNurturing(shuffled[3]),
comfort: getMatriComfort(shuffled[3])
},
putra: {
planet: shuffled[4],
symbol: getPlanetSymbol(shuffled[4]),
children: getPutraCreativity(shuffled[4]),
intelligence: getPutraIntelligence(shuffled[4])
},
gnati: {
planet: shuffled[5],
symbol: getPlanetSymbol(shuffled[5]),
obstacles: getGnatiObstacles(shuffled[5]),
disease: getGnatiDisease(shuffled[5])
},
dara: {
planet: shuffled[6],
symbol: getPlanetSymbol(shuffled[6]),
spouse: getDaraSpouse(shuffled[6]),
relationships: getDaraRelationships(shuffled[6])
}
};

// Calculate Karakamsha
karakaData.karakamsha = calculateKarakamsha(shuffled[0], soulAge);

// Calculate current Chara Dasha
karakaData.charaDasha = calculateCharaDasha(date, soulAge);

// Generate remedies
karakaData.remedies = generateJaiminiRemedies(shuffled[0], soulAge);

return karakaData;
}

function displayCharaKarakas(karakas) {
// Update Atmakaraka
document.getElementById('atmakaraka-planet').textContent = `${karakas.atmakaraka.planet} ${karakas.atmakaraka.symbol}`;
document.getElementById('ak-desire').textContent = karakas.atmakaraka.desire;
document.getElementById('ak-lesson').textContent = karakas.atmakaraka.lesson;
document.getElementById('ak-path').textContent = karakas.atmakaraka.path;

// Update other Karakas
document.getElementById('amatya-planet').textContent = `${karakas.amatya.planet} ${karakas.amatya.symbol}`;
document.getElementById('amk-career').textContent = karakas.amatya.career;
document.getElementById('amk-support').textContent = karakas.amatya.support;

document.getElementById('bhratri-planet').textContent = `${karakas.bhratri.planet} ${karakas.bhratri.symbol}`;
document.getElementById('bk-siblings').textContent = karakas.bhratri.siblings;
document.getElementById('bk-initiative').textContent = karakas.bhratri.initiative;

document.getElementById('matri-planet').textContent = `${karakas.matri.planet} ${karakas.matri.symbol}`;
document.getElementById('mk-mother').textContent = karakas.matri.mother;
document.getElementById('mk-comfort').textContent = karakas.matri.comfort;

document.getElementById('putra-planet').textContent = `${karakas.putra.planet} ${karakas.putra.symbol}`;
document.getElementById('pk-children').textContent = karakas.putra.children;
document.getElementById('pk-intelligence').textContent = karakas.putra.intelligence;

document.getElementById('gnati-planet').textContent = `${karakas.gnati.planet} ${karakas.gnati.symbol}`;
document.getElementById('gk-obstacles').textContent = karakas.gnati.obstacles;
document.getElementById('gk-disease').textContent = karakas.gnati.disease;

document.getElementById('dara-planet').textContent = `${karakas.dara.planet} ${karakas.dara.symbol}`;
document.getElementById('dk-spouse').textContent = karakas.dara.spouse;
document.getElementById('dk-relationships').textContent = karakas.dara.relationships;

// Update Karakamsha
document.getElementById('karakamsha-sign').textContent = karakas.karakamsha.sign;
document.getElementById('liberation-path').textContent = karakas.karakamsha.path;
document.getElementById('ishta-devata').textContent = karakas.karakamsha.deity;
document.getElementById('spiritual-practice').textContent = karakas.karakamsha.practice;

// Update Chara Dasha
document.getElementById('current-dasha').textContent = karakas.charaDasha.current;
document.getElementById('dasha-period').textContent = karakas.charaDasha.period;
document.getElementById('dasha-theme').textContent = karakas.charaDasha.theme;
document.getElementById('dasha-lesson').textContent = karakas.charaDasha.lesson;

// Update Remedies
document.getElementById('remedy-mantra').textContent = karakas.remedies.mantra;
document.getElementById('remedy-gem').textContent = karakas.remedies.gemstone;
document.getElementById('remedy-color').textContent = karakas.remedies.color;
document.getElementById('remedy-fast').textContent = karakas.remedies.fast;
document.getElementById('remedy-deity').textContent = karakas.remedies.deity;
document.getElementById('remedy-charity').textContent = karakas.remedies.charity;
}

// Helper functions for Jaimini calculations
function getPlanetSymbol(planet) {
const symbols = {
'Sun': '☉', 'Moon': '☽', 'Mars': '♂', 'Mercury': '☿',
'Jupiter': '♃', 'Venus': '♀', 'Saturn': '♄'
};
return symbols[planet] || '';
}

function getAtmakarakaDesire(planet) {
const desires = {
'Sun': 'Leadership & self-realization',
'Moon': 'Emotional fulfillment & nurturing',
'Mars': 'Victory & courage',
'Mercury': 'Knowledge & communication',
'Jupiter': 'Wisdom & expansion',
'Venus': 'Love & beauty',
'Saturn': 'Discipline & mastery'
};
return desires[planet];
}

function getAtmakarakaLesson(planet) {
const lessons = {
'Sun': 'Transcending ego',
'Moon': 'Emotional mastery',
'Mars': 'Right use of power',
'Mercury': 'Truth in communication',
'Jupiter': 'Humble wisdom',
'Venus': 'Detached love',
'Saturn': 'Patient perseverance'
};
return lessons[planet];
}

function getAtmakarakaPath(planet) {
const paths = {
'Sun': 'Through service & humility',
'Moon': 'Through devotion & compassion',
'Mars': 'Through disciplined action',
'Mercury': 'Through sacred knowledge',
'Jupiter': 'Through teaching & guidance',
'Venus': 'Through artistic expression',
'Saturn': 'Through karma yoga'
};
return paths[planet];
}

function getAmatyaCareer(planet) {
const careers = {
'Sun': 'Leadership & administration',
'Moon': 'Healing & counseling',
'Mars': 'Defense & protection',
'Mercury': 'Teaching & communication',
'Jupiter': 'Advisory & spiritual guidance',
'Venus': 'Arts & relationships',
'Saturn': 'Service & organization'
};
return careers[planet];
}

function getAmatyaSupport(planet) {
const support = {
'Sun': 'Authority figures',
'Moon': 'Emotional supporters',
'Mars': 'Action-oriented allies',
'Mercury': 'Intellectual peers',
'Jupiter': 'Wisdom teachers',
'Venus': 'Creative partners',
'Saturn': 'Disciplined mentors'
};
return support[planet];
}

function getBhratriTraits(planet) {
const traits = {
'Sun': 'Noble leadership',
'Moon': 'Emotional bonds',
'Mars': 'Warrior spirit',
'Mercury': 'Quick wit',
'Jupiter': 'Wise counsel',
'Venus': 'Harmonious relations',
'Saturn': 'Dutiful support'
};
return traits[planet];
}

function getBhratriInitiative(planet) {
const initiative = {
'Sun': 'Bold leader',
'Moon': 'Intuitive guide',
'Mars': 'Fearless pioneer',
'Mercury': 'Strategic planner',
'Jupiter': 'Visionary',
'Venus': 'Peace maker',
'Saturn': 'Patient builder'
};
return initiative[planet];
}

function getMatriNurturing(planet) {
const nurturing = {
'Sun': 'Royal heritage',
'Moon': 'Deep emotional bonds',
'Mars': 'Strong protection',
'Mercury': 'Intellectual stimulation',
'Jupiter': 'Spiritual wisdom',
'Venus': 'Artistic appreciation',
'Saturn': 'Disciplined structure'
};
return nurturing[planet];
}

function getMatriComfort(planet) {
const comfort = {
'Sun': 'Recognition & respect',
'Moon': 'Home & family',
'Mars': 'Active engagement',
'Mercury': 'Mental stimulation',
'Jupiter': 'Learning & growth',
'Venus': 'Beauty & harmony',
'Saturn': 'Structure & tradition'
};
return comfort[planet];
}

function getPutraCreativity(planet) {
const creativity = {
'Sun': 'Leadership projects',
'Moon': 'Emotional expression',
'Mars': 'Dynamic action',
'Mercury': 'Writing & communication',
'Jupiter': 'Wisdom teachings',
'Venus': 'Artistic creation',
'Saturn': 'Structured building'
};
return creativity[planet];
}

function getPutraIntelligence(planet) {
const intelligence = {
'Sun': 'Executive mind',
'Moon': 'Emotional intelligence',
'Mars': 'Strategic thinking',
'Mercury': 'Analytical mind',
'Jupiter': 'Philosophical wisdom',
'Venus': 'Aesthetic sense',
'Saturn': 'Practical wisdom'
};
return intelligence[planet];
}

function getGnatiObstacles(planet) {
const obstacles = {
'Sun': 'Ego conflicts',
'Moon': 'Emotional turbulence',
'Mars': 'Conflicts & competition',
'Mercury': 'Communication issues',
'Jupiter': 'Overexpansion',
'Venus': 'Relationship challenges',
'Saturn': 'Karmic delays'
};
return obstacles[planet];
}

function getGnatiDisease(planet) {
const disease = {
'Sun': 'Heart & vitality',
'Moon': 'Emotional & digestive',
'Mars': 'Inflammatory conditions',
'Mercury': 'Nervous system',
'Jupiter': 'Liver & expansion',
'Venus': 'Reproductive & hormonal',
'Saturn': 'Chronic conditions'
};
return disease[planet];
}

function getDaraSpouse(planet) {
const spouse = {
'Sun': 'Noble & confident',
'Moon': 'Nurturing & intuitive',
'Mars': 'Dynamic & passionate',
'Mercury': 'Intellectual & communicative',
'Jupiter': 'Wise & spiritual',
'Venus': 'Artistic & loving',
'Saturn': 'Mature & responsible'
};
return spouse[planet];
}

function getDaraRelationships(planet) {
const relationships = {
'Sun': 'Respectful partnership',
'Moon': 'Emotional connection',
'Mars': 'Passionate dynamics',
'Mercury': 'Mental stimulation',
'Jupiter': 'Growth-oriented',
'Venus': 'Harmony seeking',
'Saturn': 'Long-term commitment'
};
return relationships[planet];
}

function calculateKarakamsha(atmakaraka, soulAge) {
const signs = ['Aries', 'Taurus', 'Gemini', 'Cancer', 'Leo', 'Virgo', 
'Libra', 'Scorpio', 'Sagittarius', 'Capricorn', 'Aquarius', 'Pisces'];
const signIndex = Math.floor((soulAge / 777) * 12);
const sign = signs[signIndex];

const paths = {
'Aries': 'Through courageous action',
'Taurus': 'Through patient cultivation',
'Gemini': 'Through knowledge sharing',
'Cancer': 'Through emotional healing',
'Leo': 'Through creative expression',
'Virgo': 'Through selfless service',
'Libra': 'Through harmonious balance',
'Scorpio': 'Through transformation',
'Sagittarius': 'Through wisdom & teaching',
'Capricorn': 'Through disciplined practice',
'Aquarius': 'Through humanitarian service',
'Pisces': 'Through mystical union'
};

const deities = {
'Aries': 'Lord Hanuman',
'Taurus': 'Goddess Lakshmi',
'Gemini': 'Lord Ganesha',
'Cancer': 'Divine Mother',
'Leo': 'Lord Surya',
'Virgo': 'Lord Vishnu',
'Libra': 'Goddess Saraswati',
'Scorpio': 'Lord Shiva',
'Sagittarius': 'Lord Dattatreya',
'Capricorn': 'Lord Saturn',
'Aquarius': 'Lord Shiva',
'Pisces': 'Lord Vishnu/Krishna'
};

return {
sign: sign,
path: paths[sign],
deity: deities[sign],
practice: `${atmakaraka === 'Jupiter' ? 'Jnana' : 'Bhakti'} Yoga with ${deities[sign]} worship`
};
}

function calculateCharaDasha(birthDate, soulAge) {
const year = new Date().getFullYear();
const dashaLength = 7;
const currentDashaIndex = Math.floor((year - birthDate.getFullYear()) / dashaLength) % 12;

const signs = ['Aries', 'Taurus', 'Gemini', 'Cancer', 'Leo', 'Virgo', 
'Libra', 'Scorpio', 'Sagittarius', 'Capricorn', 'Aquarius', 'Pisces'];

const themes = {
'Aries': 'New beginnings & leadership',
'Taurus': 'Material consolidation',
'Gemini': 'Communication & learning',
'Cancer': 'Emotional development',
'Leo': 'Creative expression',
'Virgo': 'Service & healing',
'Libra': 'Relationships & balance',
'Scorpio': 'Deep transformation',
'Sagittarius': 'Spiritual expansion',
'Capricorn': 'Career & achievement',
'Aquarius': 'Innovation & community',
'Pisces': 'Spiritual dissolution'
};

const lessons = {
'Aries': 'Courage without aggression',
'Taurus': 'Security without attachment',
'Gemini': 'Knowledge with wisdom',
'Cancer': 'Nurturing without dependency',
'Leo': 'Leadership with humility',
'Virgo': 'Service without criticism',
'Libra': 'Harmony without indecision',
'Scorpio': 'Power without manipulation',
'Sagittarius': 'Freedom with responsibility',
'Capricorn': 'Achievement with compassion',
'Aquarius': 'Innovation with grounding',
'Pisces': 'Surrender without escapism'
};

const currentSign = signs[currentDashaIndex];
const startYear = year - (year - birthDate.getFullYear()) % dashaLength;

return {
current: `${currentSign} Dasha`,
period: `${startYear}-${startYear + dashaLength}`,
theme: themes[currentSign],
lesson: lessons[currentSign]
};
}

function generateJaiminiRemedies(atmakaraka, soulAge) {
const mantras = {
'Sun': 'Om Suryaya Namaha',
'Moon': 'Om Chandraya Namaha',
'Mars': 'Om Mangalaya Namaha',
'Mercury': 'Om Budhaya Namaha',
'Jupiter': 'Om Guruve Namaha',
'Venus': 'Om Shukraya Namaha',
'Saturn': 'Om Shanaishcharaya Namaha'
};

const gemstones = {
'Sun': 'Ruby',
'Moon': 'Pearl',
'Mars': 'Red Coral',
'Mercury': 'Emerald',
'Jupiter': 'Yellow Sapphire',
'Venus': 'Diamond',
'Saturn': 'Blue Sapphire'
};

const colors = {
'Sun': 'Orange & Gold',
'Moon': 'White & Silver',
'Mars': 'Red & Scarlet',
'Mercury': 'Green',
'Jupiter': 'Yellow & Saffron',
'Venus': 'Pink & Pastels',
'Saturn': 'Blue & Black'
};

const fastDays = {
'Sun': 'Sundays',
'Moon': 'Mondays',
'Mars': 'Tuesdays',
'Mercury': 'Wednesdays',
'Jupiter': 'Thursdays',
'Venus': 'Fridays',
'Saturn': 'Saturdays'
};

const deities = {
'Sun': 'Lord Surya',
'Moon': 'Lord Shiva',
'Mars': 'Lord Hanuman',
'Mercury': 'Lord Vishnu',
'Jupiter': 'Lord Dattatreya',
'Venus': 'Goddess Lakshmi',
'Saturn': 'Lord Shani'
};

const charities = {
'Sun': 'Donate wheat to needy',
'Moon': 'Donate white items',
'Mars': 'Donate red lentils',
'Mercury': 'Donate green items',
'Jupiter': 'Donate yellow items to Brahmins',
'Venus': 'Donate to women',
'Saturn': 'Donate black items'
};

return {
mantra: mantras[atmakaraka],
gemstone: gemstones[atmakaraka],
color: colors[atmakaraka],
fast: fastDays[atmakaraka],
deity: deities[atmakaraka],
charity: charities[atmakaraka]
};
}

// Spiritual Guidance Functions
document.getElementById('generateGuidanceBtn').addEventListener('click', () => {
if (!AppState.calculationResults) {
alert('Please calculate your soul age first in the Calculate tab.');
return;
}

generateSpiritualGuidance();
});

function generateSpiritualGuidance() {
document.getElementById('guidanceContent').style.display = 'none';

setTimeout(() => {
const guidance = createPersonalizedGuidance();
displayGuidance(guidance);

document.getElementById('guidanceContent').style.display = 'block';
document.getElementById('guidanceContent').scrollIntoView({ behavior: 'smooth' });
}, 1500);
}

function createPersonalizedGuidance() {
const soulAge = AppState.calculationResults.soulAge;
const stage = AppState.calculationResults.stage;

return {
soulRay: calculateSoulRay(soulAge),
soulGroup: determineSoulGroup(soulAge),
monadicFamily: calculateMonadicFamily(soulAge),
pastLifeThemes: generatePastLifeThemes(soulAge),
karmicDebt: calculateKarmicDebt(soulAge),
spiritualGifts: generateSpiritualGifts(soulAge),
lifePurpose: generateLifePurpose(soulAge, stage),
careerPaths: generateCareerPaths(soulAge),
shadowWork: generateShadowWork(soulAge),
ascensionSymptoms: generateAscensionSymptoms(soulAge),
sacredGeometry: determineSacredGeometry(soulAge),
chakraActivation: calculateChakraActivation(soulAge),
colorTherapy: generateColorTherapy(soulAge),
practices: generatePersonalizedPractices(soulAge, stage)
};
}

function displayGuidance(guidance) {
// Update all the guidance sections with personalized content
document.getElementById('soul-ray').textContent = guidance.soulRay.ray;
document.getElementById('soul-ray').nextElementSibling.textContent = guidance.soulRay.description;

document.getElementById('soul-group').textContent = guidance.soulGroup.name;
document.getElementById('soul-group').nextElementSibling.textContent = guidance.soulGroup.mission;

document.getElementById('monadic-family').textContent = guidance.monadicFamily.type;
document.getElementById('monadic-family').nextElementSibling.textContent = guidance.monadicFamily.description;

// Update life purpose
document.getElementById('life-purpose').textContent = guidance.lifePurpose;

// Additional updates for other sections would follow similar pattern
}

// Helper functions for guidance generation
function calculateSoulRay(soulAge) {
const rayIndex = Math.floor((soulAge / 777) * 7);
const rays = [
{ ray: 'Ray 1 - Will/Power', description: 'Leadership through divine will' },
{ ray: 'Ray 2 - Love/Wisdom', description: 'Teaching through compassion' },
{ ray: 'Ray 3 - Active Intelligence', description: 'Creating through understanding' },
{ ray: 'Ray 4 - Harmony through Conflict', description: 'Beauty through balance' },
{ ray: 'Ray 5 - Concrete Knowledge', description: 'Science and spirituality' },
{ ray: 'Ray 6 - Devotion/Idealism', description: 'Service through faith' },
{ ray: 'Ray 7 - Ceremonial Order', description: 'Manifesting spirit in matter' }
];
return rays[rayIndex] || rays[2];
}

function determineSoulGroup(soulAge) {
if (soulAge < 333) {
return {
name: 'Earth Keepers',
mission: 'Grounding spiritual energy'
};
} else if (soulAge < 555) {
return {
name: 'Blue Ray Healers',
mission: 'Healing humanity\'s consciousness'
};
} else {
return {
name: 'Violet Flame Holders',
mission: 'Transmuting collective karma'
};
}
}

function calculateMonadicFamily(soulAge) {
if (soulAge > 666) {
return {
type: '144 Soul Extension',
description: 'Part of 144,000 lightworkers'
};
} else if (soulAge > 444) {
return {
type: 'Starseed Collective',
description: 'Advanced soul volunteer'
};
} else {
return {
type: 'Earth Soul Evolution',
description: 'Native Earth soul journey'
};
}
}

function generatePastLifeThemes(soulAge) {
// Generate based on soul age
return [
'Ancient Mystery Schools',
'Leadership Roles',
'Mystic & Healer'
];
}

function calculateKarmicDebt(soulAge) {
const percentage = Math.min(95, Math.floor((soulAge / 777) * 100));
return {
resolved: percentage,
active: 100 - percentage
};
}

function generateSpiritualGifts(soulAge) {
return {
awakened: ['Intuition', 'Healing', 'Teaching'],
developing: ['Prophecy', 'Telekinesis'],
dormant: ['Bilocation', 'Materialization']
};
}

function generateLifePurpose(soulAge, stage) {
if (soulAge > 555) {
return 'To serve as a bridge between ancient wisdom and modern consciousness, helping humanity remember its divine nature through teaching, healing, and embodying unconditional love.';
} else if (soulAge > 333) {
return 'To master emotional intelligence and relationships while developing your unique gifts to serve humanity through creative expression and heart-centered living.';
} else {
return 'To explore physical existence fully, develop individual identity, and learn fundamental lessons about power, success, and material mastery.';
}
}

function generateCareerPaths(soulAge) {
if (soulAge > 555) {
return [
'Spiritual Teacher/Guide',
'Energy Healer/Therapist',
'Consciousness Researcher',
'Sacred Space Designer',
'Meditation Instructor',
'Holistic Counselor'
];
} else {
return [
'Creative Arts',
'Healthcare',
'Education',
'Environmental Work',
'Social Services',
'Technology Innovation'
];
}
}

function generateShadowWork(soulAge) {
return {
patterns: [
'Spiritual superiority',
'Boundary issues',
'Attachment to specialness',
'Impatience with others'
],
practices: [
'Humility meditation',
'Inner child healing',
'Shadow journaling',
'Ego dissolution work'
]
};
}

function generateAscensionSymptoms(soulAge) {
if (soulAge > 444) {
return [
'Crown pressure',
'Third eye activation',
'Timeline shifting',
'Vivid dreams',
'Energy surges',
'Reality shifts'
];
} else {
return [
'Awakening intuition',
'Sensitivity increase',
'Sleep pattern changes',
'Dietary shifts'
];
}
}

function determineSacredGeometry(soulAge) {
if (soulAge > 666) return 'Merkaba';
if (soulAge > 444) return 'Flower of Life';
if (soulAge > 222) return 'Seed of Life';
return 'Vesica Piscis';
}

function calculateChakraActivation(soulAge) {
return {
crown: Math.min(100, 50 + Math.floor(soulAge / 15)),
thirdEye: Math.min(100, 40 + Math.floor(soulAge / 18)),
throat: Math.min(100, 35 + Math.floor(soulAge / 20)),
heart: Math.min(100, 45 + Math.floor(soulAge / 17))
};
}

function generateColorTherapy(soulAge) {
if (soulAge > 555) {
return ['Violet', 'Indigo', 'Gold', 'White'];
} else if (soulAge > 333) {
return ['Green', 'Blue', 'Pink', 'Turquoise'];
} else {
return ['Red', 'Orange', 'Yellow', 'Earth tones'];
}
}

function generatePersonalizedPractices(soulAge, stage) {
return {
morning: [
'Gayatri Mantra',
'Heart breathing',
'Violet flame',
'Intention setting'
],
evening: [
'Karma clearing',
'Gratitude journal',
'Third eye activation',
'Astral preparation'
],
weekly: {
'Monday': 'Fasting',
'Wednesday': 'Sacred study',
'Friday': 'Service',
'Sunday': 'Nature connection'
}
};
}
</script>

    </div>

    <!-- Security Badge -->
    <div class="security-badge">
        <span>🔒</span>
        <span>Secure • No Data Storage • GDPR Compliant</span>
    </div>

    <script>
        // State Management - In-memory only, no persistence
        const AppState = {
            currentTab: 'calculate',
            birthData: null,
            surveyAnswers: {},
            calculationResults: null,
            sessionId: generateSessionId(),
            isCalculating: false
        };

        // Cities Database
        const cities = [
            { name: "New Delhi, India", lat: 28.6139, lng: 77.2090 },
            { name: "Mumbai, India", lat: 19.0760, lng: 72.8777 },
            { name: "Varanasi, India", lat: 25.3176, lng: 82.9739 },
            { name: "Rishikesh, India", lat: 30.0869, lng: 78.2676 },
            { name: "Bodh Gaya, India", lat: 24.6961, lng: 84.9869 },
            { name: "Amritsar, India", lat: 31.6340, lng: 74.8723 },
            { name: "Chennai, India", lat: 13.0827, lng: 80.2707 },
            { name: "Kolkata, India", lat: 22.5726, lng: 88.3639 },
            { name: "Bangalore, India", lat: 12.9716, lng: 77.5946 },
            { name: "Pune, India", lat: 18.5204, lng: 73.8567 },
            { name: "London, UK", lat: 51.5074, lng: -0.1278 },
            { name: "New York, USA", lat: 40.7128, lng: -74.0060 },
            { name: "Los Angeles, USA", lat: 34.0522, lng: -118.2437 },
            { name: "Tokyo, Japan", lat: 35.6762, lng: 139.6503 },
            { name: "Singapore", lat: 1.3521, lng: 103.8198 },
            { name: "Dubai, UAE", lat: 25.2048, lng: 55.2708 },
            { name: "Sydney, Australia", lat: -33.8688, lng: 151.2093 },
            { name: "Paris, France", lat: 48.8566, lng: 2.3522 },
            { name: "Cairo, Egypt", lat: 30.0444, lng: 31.2357 },
            { name: "Jerusalem, Israel", lat: 31.7683, lng: 35.2137 }
        ];

        // Spiritual Questions
        const spiritualQuestions = [
            {
                text: "How often do you experience synchronicities or meaningful coincidences?",
                options: ["Never", "Rarely", "Sometimes", "Often", "Constantly"],
                weight: 0.15
            },
            {
                text: "How naturally does meditation or contemplation come to you?",
                options: ["Very difficult", "Challenging", "Moderate", "Easy", "Effortless"],
                weight: 0.18
            },
            {
                text: "Do you feel memories or connections to past lives?",
                options: ["Never", "Rarely", "Sometimes", "Often", "Vivid memories"],
                weight: 0.20
            },
            {
                text: "How strongly do you feel your life has a specific spiritual mission?",
                options: ["No sense", "Vague feeling", "Some clarity", "Clear purpose", "Urgent mission"],
                weight: 0.17
            },
            {
                text: "How easily do you detach from material possessions and outcomes?",
                options: ["Very attached", "Somewhat attached", "Balanced", "Easily detached", "Naturally detached"],
                weight: 0.15
            },
            {
                text: "How often do you experience states of expanded consciousness?",
                options: ["Never", "Rarely", "Monthly", "Weekly", "Daily"],
                weight: 0.15
            }
        ];

        // Initialize Application
        function initApp() {
            setupTabs();
            setupForm();
            setupAutocomplete();
            initializeSurvey();
            setupValidation();
        }

        // Generate Session ID
        function generateSessionId() {
            const array = new Uint8Array(16);
            crypto.getRandomValues(array);
            return Array.from(array, b => b.toString(16).padStart(2, '0')).join('');
        }

        // Tab Navigation
        function setupTabs() {
            const tabButtons = document.querySelectorAll('.tab-btn');
            const tabContents = document.querySelectorAll('.tab-content');
            
            tabButtons.forEach(btn => {
                btn.addEventListener('click', () => {
                    const targetTab = btn.dataset.tab;
                    
                    // Update buttons
                    tabButtons.forEach(b => b.classList.remove('active'));
                    btn.classList.add('active');
                    
                    // Update content
                    tabContents.forEach(content => {
                        content.classList.remove('active');
                    });
                    document.getElementById(`${targetTab}-tab`).classList.add('active');
                    
                    AppState.currentTab = targetTab;
                });
            });
        }

        // Form Setup
        function setupForm() {
            const form = document.getElementById('birthForm');
            const calculateBtn = document.getElementById('calculateBtn');
            
            calculateBtn.addEventListener('click', (e) => {
                e.preventDefault();
                if (validateForm()) {
                    calculateSoulAge();
                }
            });
        }

        // Autocomplete Setup
        // Replace the entire setupAutocomplete() function with this:
function setupAutocomplete() {
    const input = document.getElementById('birthPlace');
    const dropdown = document.getElementById('autocompleteDropdown');
    let searchTimeout;
    let abortController;
    
    input.addEventListener('input', async (e) => {
        clearTimeout(searchTimeout);
        
        // Cancel previous request if still pending
        if (abortController) {
            abortController.abort();
        }
        
        const query = e.target.value.trim();
        
        if (query.length < 3) {
            dropdown.style.display = 'none';
            return;
        }
        
        // Show loading state
        dropdown.innerHTML = '<div class="autocomplete-item">Searching...</div>';
        dropdown.style.display = 'block';
        
        searchTimeout = setTimeout(async () => {
            try {
                abortController = new AbortController();
                
                // Call OpenStreetMap Nominatim API
                const response = await fetch(
                    `https://nominatim.openstreetmap.org/search?format=json&q=${encodeURIComponent(query)}&limit=8&addressdetails=1`,
                    {
                        signal: abortController.signal,
                        headers: {
                            'Accept-Language': 'en'
                        }
                    }
                );
                
                if (!response.ok) {
                    throw new Error('Search failed');
                }
                
                const results = await response.json();
                
                if (results.length > 0) {
                    dropdown.innerHTML = results.map(place => {
                        // Create a user-friendly display name
                        const parts = [];
                        if (place.address) {
                            if (place.address.city) parts.push(place.address.city);
                            else if (place.address.town) parts.push(place.address.town);
                            else if (place.address.village) parts.push(place.address.village);
                            else if (place.address.suburb) parts.push(place.address.suburb);
                            
                            if (place.address.state) parts.push(place.address.state);
                            if (place.address.country) parts.push(place.address.country);
                        }
                        
                        const displayName = parts.length > 0 ? parts.join(', ') : place.display_name.split(',').slice(0, 3).join(',');
                        
                        return `<div class="autocomplete-item" data-lat="${place.lat}" data-lng="${place.lon}" data-name="${displayName.replace(/"/g, '&quot;')}">
                            <div style="font-weight: 600;">${displayName}</div>
                            <div style="font-size: 0.85rem; color: #6B7280; margin-top: 2px;">${place.display_name}</div>
                        </div>`;
                    }).join('');
                    
                    // Add click handlers
                    dropdown.querySelectorAll('.autocomplete-item').forEach(item => {
                        item.addEventListener('click', () => {
                            input.value = item.dataset.name;
                            document.getElementById('latitude').value = item.dataset.lat;
                            document.getElementById('longitude').value = item.dataset.lng;
                            dropdown.style.display = 'none';
                            showValidation('placeValidation', true);
                        });
                    });
                } else {
                    dropdown.innerHTML = '<div class="autocomplete-item">No locations found. Try a different search.</div>';
                }
            } catch (error) {
                if (error.name === 'AbortError') {
                    return; // Request was cancelled
                }
                dropdown.innerHTML = '<div class="autocomplete-item">Search error. Please try again.</div>';
            }
        }, 500); // Wait 500ms after user stops typing
    });
    
    // Add geolocation button for current location
    addGeolocationButton();
    
    document.addEventListener('click', (e) => {
        if (!input.contains(e.target) && !dropdown.contains(e.target)) {
            dropdown.style.display = 'none';
        }
    });
}

// Add function to get user's current location
function addGeolocationButton() {
    const birthPlaceContainer = document.querySelector('#birthPlace').parentElement;
    
    // Create location button
    const locationBtn = document.createElement('button');
    locationBtn.type = 'button';
    locationBtn.innerHTML = '📍 Use Current Location';
    locationBtn.style.cssText = `
        margin-top: 10px;
        padding: 10px 15px;
        background: linear-gradient(45deg, #10B981, #059669);
        color: white;
        border: none;
        border-radius: 8px;
        cursor: pointer;
        font-size: 0.9rem;
        font-weight: 600;
        transition: all 0.3s ease;
        width: 100%;
    `;
    
    locationBtn.addEventListener('mouseover', () => {
        locationBtn.style.transform = 'translateY(-2px)';
        locationBtn.style.boxShadow = '0 5px 15px rgba(16, 185, 129, 0.3)';
    });
    
    locationBtn.addEventListener('mouseout', () => {
        locationBtn.style.transform = 'translateY(0)';
        locationBtn.style.boxShadow = 'none';
    });
    
    locationBtn.addEventListener('click', async () => {
        if (!navigator.geolocation) {
            alert('Geolocation is not supported by your browser');
            return;
        }
        
        locationBtn.innerHTML = '📍 Getting location...';
        locationBtn.disabled = true;
        
        navigator.geolocation.getCurrentPosition(
            async (position) => {
                const lat = position.coords.latitude;
                const lng = position.coords.longitude;
                
                // Reverse geocode to get place name
                try {
                    const response = await fetch(
                        `https://nominatim.openstreetmap.org/reverse?format=json&lat=${lat}&lon=${lng}&addressdetails=1`
                    );
                    
                    const data = await response.json();
                    
                    // Build location name
                    const address = data.address;
                    const parts = [];
                    
                    if (address.city) parts.push(address.city);
                    else if (address.town) parts.push(address.town);
                    else if (address.village) parts.push(address.village);
                    else if (address.suburb) parts.push(address.suburb);
                    
                    if (address.state) parts.push(address.state);
                    if (address.country) parts.push(address.country);
                    
                    const locationName = parts.join(', ') || 'Current Location';
                    
                    // Set the values
                    document.getElementById('birthPlace').value = locationName;
                    document.getElementById('latitude').value = lat.toFixed(4);
                    document.getElementById('longitude').value = lng.toFixed(4);
                    showValidation('placeValidation', true);
                    
                    locationBtn.innerHTML = '📍 Location Set!';
                    setTimeout(() => {
                        locationBtn.innerHTML = '📍 Use Current Location';
                        locationBtn.disabled = false;
                    }, 2000);
                    
                } catch (error) {
                    console.error('Reverse geocoding failed:', error);
                    // Still use coordinates even if name lookup fails
                    document.getElementById('birthPlace').value = `Lat: ${lat.toFixed(4)}, Lng: ${lng.toFixed(4)}`;
                    document.getElementById('latitude').value = lat.toFixed(4);
                    document.getElementById('longitude').value = lng.toFixed(4);
                    showValidation('placeValidation', true);
                    
                    locationBtn.innerHTML = '📍 Use Current Location';
                    locationBtn.disabled = false;
                }
            },
            (error) => {
                console.error('Geolocation error:', error);
                let message = 'Could not get location. ';
                switch(error.code) {
                    case error.PERMISSION_DENIED:
                        message += 'Permission denied.';
                        break;
                    case error.POSITION_UNAVAILABLE:
                        message += 'Location unavailable.';
                        break;
                    case error.TIMEOUT:
                        message += 'Request timed out.';
                        break;
                }
                alert(message + ' Please type your location instead.');
                
                locationBtn.innerHTML = '📍 Use Current Location';
                locationBtn.disabled = false;
            }
        );
    });
    
    birthPlaceContainer.appendChild(locationBtn);
}

// Remove or comment out the cities array completely
// const cities = [...]; // DELETE THIS ENTIRE ARRAY

        // Initialize Survey
        function initializeSurvey() {
            const container = document.getElementById('surveyQuestions');
            
            spiritualQuestions.forEach((q, index) => {
                const card = document.createElement('div');
                card.className = 'question-card';
                card.innerHTML = `
                    <div class="question-text">${q.text}</div>
                    <select id="q${index}" data-index="${index}">
                        <option value="">Select your answer...</option>
                        ${q.options.map((opt, i) => 
                            `<option value="${i}">${opt}</option>`
                        ).join('')}
                    </select>
                `;
                
                card.querySelector('select').addEventListener('change', (e) => {
                    AppState.surveyAnswers[index] = parseInt(e.target.value);
                });
                
                container.appendChild(card);
            });
        }

        // Validation Setup
        function setupValidation() {
            const birthDate = document.getElementById('birthDate');
            const birthHour = document.getElementById('birthHour');
            const birthMinute = document.getElementById('birthMinute');
            const ampm = document.getElementById('ampm');
            
            birthDate.addEventListener('blur', () => validateDate());
            [birthHour, birthMinute, ampm].forEach(el => {
                el.addEventListener('change', () => validateTime());
            });
        }

        // Validation Functions
        function validateDate() {
            const input = document.getElementById('birthDate');
            const date = new Date(input.value);
            const now = new Date();
            const minDate = new Date(now.getFullYear() - 150, 0, 1);
            
            if (!input.value) {
                showError('dateError', 'Birth date is required');
                showValidation('dateValidation', false);
                return false;
            }
            
            if (date > now) {
                showError('dateError', 'Birth date cannot be in the future');
                showValidation('dateValidation', false);
                return false;
            }
            
            if (date < minDate) {
                showError('dateError', 'Birth date seems too far in the past');
                showValidation('dateValidation', false);
                return false;
            }
            
            hideError('dateError');
            showValidation('dateValidation', true);
            return true;
        }

        function validateTime() {
            const hour = document.getElementById('birthHour').value;
            const minute = document.getElementById('birthMinute').value;
            const ampm = document.getElementById('ampm').value;
            
            if (!hour || !ampm) {
                showValidation('timeValidation', false);
                return false;
            }
            
            const min = parseInt(minute) || 0;
            if (min < 0 || min > 59) {
                showError('timeError', 'Minutes must be between 0 and 59');
                showValidation('timeValidation', false);
                return false;
            }
            
            hideError('timeError');
            showValidation('timeValidation', true);
            return true;
        }

        function validateForm() {
            const dateValid = validateDate();
            const timeValid = validateTime();
            const placeValid = document.getElementById('latitude').value && 
                               document.getElementById('longitude').value;
            
            if (!placeValid) {
                showError('placeError', 'Please select a location from the dropdown');
                showValidation('placeValidation', false);
            } else {
                hideError('placeError');
                showValidation('placeValidation', true);
            }
            
            return dateValid && timeValid && placeValid;
        }

        // Error Display
        function showError(id, message) {
            const errorEl = document.getElementById(id);
            if (errorEl) {
                errorEl.textContent = message;
                errorEl.classList.add('show');
            }
        }

        function hideError(id) {
            const errorEl = document.getElementById(id);
            if (errorEl) {
                errorEl.classList.remove('show');
            }
        }

        function showValidation(id, isValid) {
            const indicator = document.getElementById(id);
            if (indicator) {
                indicator.className = `validation-indicator ${isValid ? 'valid' : 'invalid'}`;
            }
        }

        // Soul Age Calculation
        function calculateSoulAge() {
            if (AppState.isCalculating) return;
            
            AppState.isCalculating = true;
            
            // Collect form data
            const birthDate = new Date(document.getElementById('birthDate').value);
            const hour = parseInt(document.getElementById('birthHour').value);
            const minute = parseInt(document.getElementById('birthMinute').value) || 0;
            const ampm = document.getElementById('ampm').value;
            const lat = parseFloat(document.getElementById('latitude').value);
            const lng = parseFloat(document.getElementById('longitude').value);
            
            // Store in app state
            AppState.birthData = {
                date: birthDate,
                hour: hour,
                minute: minute,
                ampm: ampm,
                latitude: lat,
                longitude: lng
            };
            
            // Show loading
            document.getElementById('loading').classList.add('show');
            document.getElementById('calculateBtn').disabled = true;
            
            // Simulate calculation
            setTimeout(() => {
                const results = performCalculation();
                AppState.calculationResults = results;
                displayResults(results);
                
                document.getElementById('loading').classList.remove('show');
                document.getElementById('calculateBtn').disabled = false;
                AppState.isCalculating = false;
            }, 2500);
        }

        function performCalculation() {
            const { date, hour, minute, ampm, latitude, longitude } = AppState.birthData;
            
            // Convert to 24-hour
            let hour24 = hour;
            if (ampm === 'PM' && hour !== 12) hour24 += 12;
            if (ampm === 'AM' && hour === 12) hour24 = 0;
            
            // Vedantic calculation based on birth chart
            const dayOfYear = getDayOfYear(date);
            const timeScore = (hour24 * 60 + minute) / 1440;
            const latitudeModifier = Math.abs(latitude) / 90;
            
            // Base calculation
            let baseAge = 200 + (dayOfYear * 1.1) + (timeScore * 150) + (latitudeModifier * 50);
            
            // Survey modifier
            let surveyModifier = 0;
            Object.entries(AppState.surveyAnswers).forEach(([index, value]) => {
                const weight = spiritualQuestions[index].weight;
                surveyModifier += value * weight * 40;
            });
            
            const soulAge = Math.round(baseAge + surveyModifier);
            const constrainedAge = Math.min(Math.max(soulAge, 1), 777);
            
            return {
                soulAge: constrainedAge,
                range: [constrainedAge - 15, constrainedAge + 15],
                earthYears: constrainedAge * 165,
                spiralLevel: Math.ceil(constrainedAge / 111),
                remainingLives: 777 - constrainedAge,
                stage: getSoulStage(constrainedAge),
                characteristics: getCharacteristics(constrainedAge)
            };
        }

        function getDayOfYear(date) {
            const start = new Date(date.getFullYear(), 0, 0);
            const diff = date - start;
            const oneDay = 1000 * 60 * 60 * 24;
            return Math.floor(diff / oneDay);
        }

        function getSoulStage(age) {
            if (age <= 111) return "Mineral & Elemental Kingdom - Earth Consciousness";
            if (age <= 222) return "Plant Kingdom - Life Force Awakening";
            if (age <= 333) return "Animal Kingdom - Emotional Development";
            if (age <= 444) return "Young Human Soul - Ego Crystallization";
            if (age <= 555) return "Mature Human Soul - Heart Chakra Activation";
            if (age <= 666) return "Old Human Soul - Wisdom Integration";
            return "Transcendent Soul - Approaching Liberation";
        }

        function getCharacteristics(age) {
            const characteristics = {
                strengths: [],
                challenges: [],
                focus: [],
                practices: []
            };
            
            if (age > 444 && age <= 555) {
                characteristics.strengths = [
                    "Deep emotional intelligence",
                    "Strong empathic abilities",
                    "Natural healing presence",
                    "Relationship wisdom"
                ];
                characteristics.challenges = [
                    "Emotional overwhelm",
                    "Boundary setting",
                    "Past life trauma healing"
                ];
                characteristics.focus = [
                    "Heart-centered consciousness",
                    "Unconditional love development",
                    "Emotional mastery"
                ];
                characteristics.practices = [
                    "Heart chakra meditation",
                    "Loving-kindness practice",
                    "Emotional release work",
                    "Sacred relationships"
                ];
            } else if (age > 555) {
                characteristics.strengths = [
                    "Natural wisdom and detachment",
                    "Spiritual teaching ability",
                    "Cosmic perspective",
                    "Karmic pattern recognition"
                ];
                characteristics.challenges = [
                    "Material world engagement",
                    "Patience with younger souls",
                    "Avoiding spiritual bypassing"
                ];
                characteristics.focus = [
                    "Wisdom transmission",
                    "Service to collective",
                    "Preparation for liberation"
                ];
                characteristics.practices = [
                    "Advanced meditation",
                    "Jnana yoga (self-inquiry)",
                    "Karma yoga (selfless service)",
                    "Guru yoga"
                ];
            } else {
                characteristics.strengths = [
                    "Strong life force",
                    "Material world mastery",
                    "Goal achievement",
                    "Physical vitality"
                ];
                characteristics.challenges = [
                    "Ego identification",
                    "Spiritual awakening",
                    "Emotional depth"
                ];
                characteristics.focus = [
                    "Personal development",
                    "Success and achievement",
                    "Identity formation"
                ];
                characteristics.practices = [
                    "Grounding practices",
                    "Physical yoga",
                    "Breathwork",
                    "Nature connection"
                ];
            }
            
            return characteristics;
        }

        function displayResults(results) {
            // Update main display
            document.getElementById('soulAgeNumber').textContent = `~${results.soulAge}`;
            document.getElementById('soulStage').textContent = results.stage;
            document.getElementById('incarnationRange').textContent = 
                `${results.range[0]}-${results.range[1]}`;
            document.getElementById('earthYears').textContent = 
                `~${Math.round(results.earthYears / 1000)}k`;
            document.getElementById('spiralLevel').textContent = 
                `${results.spiralLevel}${getOrdinalSuffix(results.spiralLevel)}`;
            document.getElementById('remainingLives').textContent = results.remainingLives;
.autocomplete-item {
    padding: 12px 15px;
    cursor: pointer;
    border-bottom: 1px solid var(--border);
    transition: background 0.2s;
}

.autocomplete-item:hover {
    background: #F3F4F6;
}

.autocomplete-item:last-child {
    border-bottom: none;
}

.autocomplete-dropdown {
    max-height: 300px;
    overflow-y: auto;
}

/* Loading state */
.autocomplete-dropdown .loading {
    padding: 20px;
    text-align: center;
    color: #6B7280;
}

            
            // Display characteristics
            const charDisplay = document.getElementById('characteristicsDisplay');
            charDisplay.innerHTML = `
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px;">
                    <div>
                        <h4 style="color: var(--primary); margin-bottom: 10px;">🌟 Soul Strengths</h4>
                        <ul style="list-style: none; padding: 0;">
                            ${results.characteristics.strengths.map(s => 
                                `<li style="padding: 5px 0;">✓ ${s}</li>`
                            ).join('')}
                        </ul>
                    </div>
                    <div>
                        <h4 style="color: var(--primary); margin-bottom: 10px;">🎯 Current Focus</h4>
                        <ul style="list-style: none; padding: 0;">
                            ${results.characteristics.focus.map(f => 
                                `<li style="padding: 5px 0;">• ${f}</li>`
                            ).join('')}
                        </ul>
                    </div>
                    <div>
                        <h4 style="color: var(--primary); margin-bottom: 10px;">⚡ Growth Challenges</h4>
                        <ul style="list-style: none; padding: 0;">
                            ${results.characteristics.challenges.map(c => 
                                `<li style="padding: 5px 0;">• ${c}</li>`
                            ).join('')}
                        </ul>
                    </div>
                    <div>
                        <h4 style="color: var(--primary); margin-bottom: 10px;">🧘 Recommended Practices</h4>
                        <ul style="list-style: none; padding: 0;">
                            ${results.characteristics.practices.map(p => 
                                `<li style="padding: 5px 0;">• ${p}</li>`
                            ).join('')}
                        </ul>
                    </div>
                </div>
            `;
            
            // Show results
            document.getElementById('resultsContainer').classList.add('show');
            
            // Highlight corresponding stage in Understanding tab
            highlightEvolutionStage(results.soulAge);
        }

        function highlightEvolutionStage(soulAge) {
            document.querySelectorAll('.stage-card').forEach(card => {
                card.classList.remove('current');
                const range = card.dataset.range;
                if (range) {
                    const [min, max] = range.split('-').map(n => parseInt(n));
                    if (soulAge >= min && soulAge <= max) {
                        card.classList.add('current');
                    }
                }
            });
        }

        function getOrdinalSuffix(n) {
            const s = ["th", "st", "nd", "rd"];
            const v = n % 100;
            return s[(v - 20) % 10] || s[v] || s[0];
        }

        // Initialize on load
        document.addEventListener('DOMContentLoaded', initApp);
    </script>
</body>
</html>
